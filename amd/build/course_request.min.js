define ("theme_urcourses_default/course_request",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events","theme_urcourses_default/course_actions"],function(a,b,c,d,e,f,g){var h,i,j,k,l={HEADER:"#page-header .header-body",HEADER_TOP:"#page-header .page-head",BTN_COURSETOOLS:"#btn_coursetools",BTN_DUPLICATE:"#btn_duplicate",BTN_NEW:"#btn_new",BTN_STUDENT_ACCOUNT:"#btn_student_account",BTN_STUDENT_ENROL:"#btn_student_enrol",BTN_DESCRIPTION:"#btn_editdescription"},m=function(b,c,d,e){h=a(b);i=c;k=d;j=e;g=new g(i.id,i.coursename,i.shortname,i.startdate,i.enddate,k,j)},n=function(){h.on("click",l.BTN_COURSETOOLS,o);h.on("click",l.BTN_DUPLICATE,o);h.on("click",l.BTN_NEW,o);h.on("click",l.BTN_DESCRIPTION,v);h.on("click",l.BTN_STUDENT_ACCOUNT,p);h.on("click",l.BTN_STUDENT_ENROL,t)},o=function(){var b=a(this);g.coursereqAction(b,"btn_new",i.category,i.startdate,i.enddate)},p=function(){var b=this.getAttribute("value"),c=this.getAttribute("aria-username");if(b){var d=q(c),g="User details for test student account";e.create({type:e.types.CANCEL,title:g,body:"<div class=\"card\" style=\"width: 18rem;\"><div class=\"card-body\"><p class=\"card-text\"><b>Email address </b><br>"+d.email+"<br><b>Username </b><br>"+d.username+"<br><b>Account Creation Date </b><br>"+d.datecreated+"<div class=\"alert alert-warning\" role=\"alert\">Reset test account password<button id=\"test_account_reset\" type=\"button\" class=\"btn btn-primary\">Reset Password</button></div></p></div> </div>"}).then(function(b){var c=b.getRoot();a(c).find("button[data-action=\"cancel\"]").text("Close");a("\"#test_account_reset\"").bind("click",function(){_resetStudentAccount(a(this))});b.show();c.on(f.hidden,function(){a("#test_account_reset").remove()})})}else{var g="Create and enroll test student account in course";e.create({type:e.types.SAVE_CANCEL,title:g,body:"<p><b>Do you want to "+("create the test student account "+c+"+urstudent@uregina.ca")+"?</b><br /></p>"}).then(function(a){a.setSaveButtonText("Create");var b=a.getRoot();b.on(f.cancel,function(){});b.on(f.save,function(){r(c)});a.show()})}},q=function(a){if(!i.id){return}var d={courseid:i.id,username:a},e={methodname:"theme_urcourses_default_header_test_account_info",args:d,fail:c.exception},f=b.call([e]);f[0].done(function(a){return a}).fail(function(){c.exception})},r=function(a){if(!i.id){return}var d={courseid:i.id,username:a},e={methodname:"theme_urcourses_default_header_create_test_account",args:d,fail:c.exception},f=b.call([e]);f[0].done(function(a){s(a)}).fail(function(){c.exception})},s=function(b){if("undefined"!=typeof b.unenroll){}else if(!("undefined"!=typeof b.enroll)){title="Success: ";info="";action=" Would you like to logout, inorder to login to new account?";if(!1!=b.created&&!1!=b.enrolled){info=b.username+" was created and enrolled into this course. Login password is the same as current account."}else if(!1!=b.created&&!1==b.enrolled){info=b.username+" was created, but FAILED to be enrolled into this course"}else if(!1==b.created&&!1!=b.enrolled){info=b.username+" already existed, and has now been enrolled into this course. Login password is the same as current account."}else{title="ERROR:";info=b.username+" already exists and is enrolled into the course";e.create({title:title,body:"<p><b>"+info+"</b><br></p>"}).done(function(a){a.show()});return}}e.create({type:e.types.SAVE_CANCEL,title:title,body:"<p><b>"+info+"</b><br>"+action+"<br /></p>"}).then(function(c){c.setSaveButtonText("Logout");var d=c.getRoot();d.on(f.cancel,function(){});d.on(f.save,function(){var c=a("a[data-title=\"logout,moodle\"]").attr("href");window.location.href=c;a("#username").value=b.username});c.show()})},t=function(a){var b=this.getAttribute("value"),a=this.getAttribute("aria-username"),c=b?"Disenroll test student account in course":"Enroll test student account in course",d=b?"remove ":"create the test student account ";d=d+a+"+urstudent@uregina.ca from course?";e.create({type:e.types.SAVE_CANCEL,title:c,body:"<p><b>Do you want to "+d+"?</b><br /></p>"}).then(function(c){c.setSaveButtonText("Create");var d=c.getRoot();d.on(f.cancel,function(){});d.on(f.save,function(){b?u(a):r(a)});c.show()})},u=function(a){if(!i.id){return}var d={courseid:i.id,username:a},e={methodname:"theme_urcourses_default_header_unenroll_test_account",args:d,fail:c.exception},f=b.call([e]);f[0].done(function(a){s(a)}).fail(function(){c.exception})},v=function(){var a=window.location.href;a=a.substring(0,a.lastIndexOf("/"));var b=a+"/edit.php?id="+i.id+"#id_descriptionhdr";window.location.href=b},w=function(){var b=window.location.href;if(0<=b.indexOf("course/edit.php")){if(""!=window.location.hash){var c=a(".navbar").outerHeight();a("html, body").animate({scrollTop:a(window.location.hash).offset().top-c},2e3)}}};return{init:function init(a,b,c,d){m(a,b,c,d);n();w()}}});
//# sourceMappingURL=course_request.min.js.map
