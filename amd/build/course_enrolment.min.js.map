{"version":3,"sources":["../src/course_enrolment.js"],"names":["define","$","ajax","notification","str","ModalFactory","ModalEvents","courseActionsLib","_root","_course","_element","_semester","_semesterdates","_categories","_templatelist","_homeurl","SELECTORS","HEADER","HEADER_TOP","BTN_COURSEENROL","BTN_ENROLTERM","STARTHOLDER","ENDHOLDER","STARTDAY","STARTMONTH","STARTYEAR","STARTHOUR","STARTMINUTE","ENDDAY","ENDMONTH","ENDYEAR","ENDHOUR","ENDMINUTE","ENDENABLE","ERR_START","ERR_END","TEMPLATES","MODAL_COURSE_ACTION_CONTENT","_setGlobals","root","course","semesterdates","categories","templatelist","homeurl","id","coursename","shortname","startdate","enddate","_registerEventListeners","on","_getEnrolInfo","_registerSelectorEventListeners","bind","_setActiveTemplate","e","templateHolder","hasClass","removeClass","find","addClass","_registerDeleteButtons","_deleteConfirmation","attr","args","courseid","semester","promise","call","methodname","done","response","_populateModal","fail","exception","data","modaltitle","activatedlist","activatedtitle","isavailable","isavaliable","courseinfo","length","each","key","value","crn","subject","section","activated","linkedClass","linked","urid","fullname","create","type","types","SAVE_CANCEL","CANCEL","title","body","output","then","modal","footer","prepend","setSaveButtonText","getRoot","cancel","save","selectedTemplates","preventDefault","text","show","templateids","i","push","groupcheck","prop","_addEnrolmentDateConfirm","hidden","remove","self","render","template","month","mday","year","_addEnrolment","validate","Date","getFullYear","getMonth","getDate","jQuery","index","item","starttemp","split","endtemp","populateDateSelects","registerDateEventListeners","startday","val","startmonth","startyear","endyear","endday","endmonth","test","getTime","is","isoriginal","mon","hours","minutes","starthour","startminute","endhour","endminute","crns","ajaxCall","result","location","reload","element","_deleteEnrollment","trigger","init"],"mappings":"kYA4BAA,OAAM,4CAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAA6C,UAA7C,CACH,oBADG,CACmB,mBADnB,CACuC,wCADvC,CAAD,CACmF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgCC,CAAhC,CAAqCC,CAArC,CAAmDC,CAAnD,CAA+DC,CAA/D,CAAiF,IAGlKC,CAAAA,CAHkK,CAKlKC,CALkK,CAMlKC,CANkK,CAOlKC,CAPkK,CAQlKC,CARkK,CASlKC,CATkK,CAUlKC,CAVkK,CAWlKC,CAXkK,CAclKC,CAAS,CAAG,CACZC,MAAM,CAAE,2BADI,CAEZC,UAAU,CAAE,yBAFA,CAGZC,eAAe,CAAE,kBAHL,CAIZC,aAAa,CAAE,gBAJH,CAKZC,WAAW,CAAE,2BALD,CAMZC,SAAS,CAAE,yBANC,CAOZC,QAAQ,CAAE,yBAPE,CAQZC,UAAU,CAAE,2BARA,CASZC,SAAS,CAAE,0BATC,CAUZC,SAAS,CAAE,0BAVC,CAWZC,WAAW,CAAE,4BAXD,CAYZC,MAAM,CAAE,uBAZI,CAaZC,QAAQ,CAAE,yBAbE,CAcZC,OAAO,CAAE,wBAdG,CAeZC,OAAO,CAAE,wBAfG,CAgBZC,SAAS,CAAE,0BAhBC,CAiBZC,SAAS,CAAE,+BAjBC,CAkBZC,SAAS,CAAE,2BAlBC,CAmBZC,OAAO,CAAE,yBAnBG,CAdsJ,CAmChKC,CAAS,CAAG,CACdC,2BAA2B,CAAE,kDADf,CAnCoJ,CA8ClKC,CAAW,CAAG,SAASC,CAAT,CAAeC,CAAf,CAAsBC,CAAtB,CAAoCC,CAApC,CAA+CC,CAA/C,CAA4DC,CAA5D,CAAqE,CACpFpC,CAAK,CAAGP,CAAC,CAACsC,CAAD,CAAT,CACA9B,CAAO,CAAG+B,CAAV,CACA5B,CAAc,CAAG6B,CAAjB,CACA5B,CAAW,CAAG6B,CAAd,CACA5B,CAAa,CAAG6B,CAAhB,CACA5B,CAAQ,CAAG6B,CAAX,CAGArC,CAAgB,CAAG,GAAIA,CAAAA,CAAJ,CAAqBE,CAAO,CAACoC,EAA7B,CAAgCpC,CAAO,CAACqC,UAAxC,CAAoDrC,CAAO,CAACsC,SAA5D,CAAuEtC,CAAO,CAACuC,SAA/E,CAA0FvC,CAAO,CAACwC,OAAlG,CAA2GnC,CAA3G,CAAyHD,CAAzH,CACrB,CAxDqK,CA8DlKqC,CAAuB,CAAG,UAAW,CACrC1C,CAAK,CAAC2C,EAAN,CAAS,OAAT,CAAkBnC,CAAS,CAACI,aAA5B,CAA2CgC,CAA3C,CACH,CAhEqK,CAqElKC,CAA+B,CAAG,UAAmB,CAErDpD,CAAC,CAAC,aAAD,CAAD,CAAiBqD,IAAjB,CAAsB,OAAtB,CAA+B,UAAW,CAAEC,CAAkB,CAACtD,CAAC,CAAC,IAAD,CAAF,CAAW,CAAzE,CACH,CAxEqK,CA4EnKsD,CAAkB,CAAG,SAASC,CAAT,CAAY,CAEhCC,cAAc,CAAGxD,CAAC,CAAC,kCAAD,CAAlB,CAEA,GAAGuD,CAAC,CAACE,QAAF,CAAW,QAAX,CAAH,CAAwB,CAEpBF,CAAC,CAACG,WAAF,CAAc,QAAd,EAEAH,CAAC,CAACI,IAAF,CAAO,oBAAP,EAA6BC,QAA7B,CAAsC,aAAtC,EACAL,CAAC,CAACI,IAAF,CAAO,cAAP,EAAuBD,WAAvB,CAAmC,mBAAnC,CACH,CAND,IAMK,CAEDH,CAAC,CAACK,QAAF,CAAW,QAAX,EAEAL,CAAC,CAACI,IAAF,CAAO,cAAP,EAAuBC,QAAvB,CAAgC,mBAAhC,EACAL,CAAC,CAACI,IAAF,CAAO,oBAAP,EAA6BD,WAA7B,CAAyC,aAAzC,CACH,CACJ,CA7FqK,CAmGlKG,CAAsB,CAAG,UAAW,CAEpC7D,CAAC,CAAC,qCAAD,CAAD,CAAuCqD,IAAvC,CAA4C,OAA5C,CAAqD,UAAW,CAAES,CAAmB,CAAC9D,CAAC,CAAC,IAAD,CAAF,CAAY,CAAjG,CACH,CAtGqK,CA4GlKmD,CAAa,CAAG,UAAW,CAE3B1C,CAAQ,CAAGT,CAAC,CAAC,IAAD,CAAZ,CACAU,CAAS,CAAGD,CAAQ,CAACsD,IAAT,CAAc,IAAd,CAAZ,CAGA,GAAI,CAACvD,CAAO,CAACoC,EAAb,CAAiB,CACb,MACH,CAR0B,GAUvBoB,CAAAA,CAAI,CAAG,CACPC,QAAQ,CAAEzD,CAAO,CAACoC,EADX,CAEPsB,QAAQ,CAAExD,CAFH,CAVgB,CAsBvByD,CAAO,CAAGlE,CAAI,CAACmE,IAAL,CAAU,CANT,CACXC,UAAU,CAAE,gDADD,CAEXL,IAAI,CAAEA,CAFK,CAMS,CAAV,CAtBa,CAuB3BG,CAAO,CAAC,CAAD,CAAP,CAAWG,IAAX,CAAgB,SAASC,CAAT,CAAmB,CAC/BC,CAAc,CAACD,CAAD,CACjB,CAFD,EAEGE,IAFH,CAEQ,UAAa,CACjBvE,CAAY,CAACwE,SAChB,CAJD,CAKH,CAxIqK,CA8IlKF,CAAc,CAAG,SAASG,CAAT,CAAe,CAGhC,GAAIC,CAAAA,CAAU,CAAG,wBAAwBD,CAAI,CAACT,QAA9C,CAEAW,aAAa,CAAG,EAAhB,CACAC,cAAc,CAAG,EAAjB,CACAC,WAAW,CAAGJ,CAAI,CAACK,WAAnB,CAEAtC,YAAY,4JAAZ,CAGA,GAA4B,CAAzB,EAAAiC,CAAI,CAACM,UAAL,CAAgBC,MAAnB,CAA8B,CAE1BlF,CAAC,CAACmF,IAAF,CAAQR,CAAI,CAACM,UAAb,CAAyB,SAAUG,CAAV,CAAeC,CAAf,CAAuB,CAC5C3C,YAAY,EAAI,uGAAmG2C,CAAK,CAACC,GAAzG,gEAEAD,CAAK,CAACE,OAFN,CAEgB,GAFhB,CAEqBF,CAAK,CAAC9C,MAF3B,CAEoC,GAFpC,CAE0C8C,CAAK,CAACG,OAFhD,cAInB,CALD,EAOA9C,YAAY,yOAMf,CAfD,IAeK,CAGDA,YAAY,2LAGf,CAGD,GAA2B,CAAxB,EAAAiC,CAAI,CAACc,SAAL,CAAeP,MAAlB,CAA6B,CACzBJ,cAAc,CAAG,0FAAjB,CACAD,aAAa,EAAI,4BAAjB,CACA7E,CAAC,CAACmF,IAAF,CAAQR,CAAI,CAACc,SAAb,CAAwB,SAAUL,CAAV,CAAeC,CAAf,CAAuB,CAC3C,GAAIK,CAAAA,CAAW,CAAG,eAAlB,CACA,GAAGL,CAAK,CAACM,MAAT,CAAgB,CACZD,CAAW,CAAG,eACjB,CAEDb,aAAa,EAAG,0DAAyDa,CAAzD,6GACkGL,CAAK,CAACC,GADxG,CAC4G,GAD5G,CACgHD,CAAK,CAACO,IADtH,oCAEOP,CAAK,CAACE,OAFb,CAEuB,GAFvB,CAE4BF,CAAK,CAAC9C,MAFlC,CAE2C,GAF3C,CAEiD8C,CAAK,CAACG,OAFvD,sBAGkBH,CAAK,CAACQ,QAHxB,cAKf,CAXL,EAYIhB,aAAa,EAAI,YACxB,CACDnC,YAAY,EAAI,QAAhB,CAGAtC,CAAY,CAAC0F,MAAb,CAAoB,CAChBC,IAAI,CAA6B,CAA1B,EAAApB,CAAI,CAACM,UAAL,CAAgBC,MAAjB,CAAgC9E,CAAY,CAAC4F,KAAb,CAAmBC,WAAnD,CAAgE7F,CAAY,CAAC4F,KAAb,CAAmBE,MADzE,CAEhBC,KAAK,CAAEvB,CAFS,CAGhBwB,IAAI,CAAIrB,WAAD,CAAgB,mJAEbrC,YAFa,CAGd,OAHc,CAIboC,cAJa,CAKbD,aALa,CAMb,MANH,CAMYwB,MATH,CAApB,EAUGC,IAVH,CAUQ,SAASC,CAAT,CAAgB,CAEpBA,CAAK,CAACC,MAAN,CAAaC,OAAb,CAAqB,yFAAoF3F,CAApF,CAA6F,kDAAlH,EAEA,GAAGiE,WAAW,EAA8B,CAA1B,EAAAJ,CAAI,CAACM,UAAL,CAAgBC,MAAlC,CAA8C,CAC1CqB,CAAK,CAACG,iBAAN,CAAwB,MAAxB,EACA,GAAIpE,CAAAA,CAAI,CAAGiE,CAAK,CAACI,OAAN,EAAX,CACArE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACuG,MAApB,CAA4B,UAAU,CAErC,CAFD,EAIAtE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACwG,IAApB,CAA0B,SAAStD,CAAT,CAAW,CAEjCC,cAAc,CAAGxD,CAAC,CAAC,kCAAD,CAAlB,CACA8G,iBAAiB,CAAG9G,CAAC,CAACwD,cAAD,CAAD,CAAkBG,IAAlB,CAAuB,SAAvB,CAApB,CAEA,GAA8B,CAA3B,EAAAmD,iBAAiB,CAAC5B,MAArB,CAAgC,CAC5B3B,CAAC,CAACwD,cAAF,GACA/G,CAAC,CAAC,6BAAD,CAAD,CAAiCgH,IAAjC,CAAsC,gCAAtC,EACAhH,CAAC,CAAC,6BAAD,CAAD,CAAiC+D,IAAjC,CAAsC,SAAtC,CAAiD,OAAjD,EACA/D,CAAC,CAAC,6BAAD,CAAD,CAAiCiH,IAAjC,EACH,CALD,IAKK,CAED,OADIC,CAAAA,CAAW,CAAG,EAClB,CAAQC,CAAC,CAAG,CAAZ,CAAeA,CAAC,CAACL,iBAAiB,CAAC5B,MAAnC,CAA2CiC,CAAC,EAA5C,CAA+C,CAC3CD,CAAW,CAACE,IAAZ,CAAkB,CAAC,IAAOpH,CAAC,CAAC8G,iBAAiB,CAACK,CAAD,CAAlB,CAAD,CAAwBpD,IAAxB,CAA6B,IAA7B,CAAR,CAAlB,CACH,CACD,GAAIsD,CAAAA,CAAU,CAAGrH,CAAC,CAAC,sBAAD,CAAD,CAA0BsH,IAA1B,CAA+B,SAA/B,CAAjB,CACAC,CAAwB,CAAC5C,CAAI,CAACM,UAAN,CAAkBiC,CAAlB,CAA+BG,CAA/B,CAC3B,CACJ,CAlBD,CAmBH,CA1BD,IA0BK,CACD,GAAI/E,CAAAA,CAAI,CAAGiE,CAAK,CAACI,OAAN,EAAX,CACArE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACuG,MAApB,CAA4B,UAAU,CAErC,CAFD,CAGH,CAEDtE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACmH,MAApB,CAA4B,UAAW,CAEnCxH,CAAC,CAAE,iCAAF,CAAD,CAAuCyH,MAAvC,EACH,CAHD,EAIAlB,CAAK,CAACU,IAAN,EACH,CApDD,EAoDG3C,IApDH,CAoDQ,UAAgB,CAIpB,GAAGS,WAAH,CAAe,CACX,GAA0B,CAAvB,CAAAJ,CAAI,CAACM,UAAL,CAAgBC,MAAnB,CAA6B,CACzB9B,CAA+B,CAAC3C,CAAD,CAClC,CAFD,IAEK,CACDT,CAAC,CAAC,gCAAD,CAAD,CAAkCgH,IAAlC,CAAuC,OAAvC,CACH,CACJ,CACD,GAA2B,CAAxB,EAAArC,CAAI,CAACc,SAAL,CAAeP,MAAlB,CAA6B,CACzBrB,CAAsB,EACzB,CACJ,CAlED,CAmEH,CAzQqK,CA+QlK0D,CAAwB,4DAAG,WAAe5C,CAAf,CAAqBuC,CAArB,CAAiCG,CAAjC,2FAGvBzC,CAHuB,CAGV,wCAHU,gBAIL8C,CAAAA,IAAI,CAACC,MAAL,CAAYxF,CAAS,CAACC,2BAAtB,CAJK,QAIvBwF,CAJuB,QAO3BxH,CAAY,CAAC0F,MAAb,CAAoB,CAChBC,IAAI,CAAE3F,CAAY,CAAC4F,KAAb,CAAmBC,WADT,CAEhBE,KAAK,CAAEvB,CAFS,CAGhBwB,IAAI,CAAG,8BACE5F,CAAO,CAACuC,SAAR,CAAkB8E,KADpB,CAC0BrH,CAAO,CAACuC,SAAR,CAAkB+E,IAD5C,CACiD,IADjD,CACsDtH,CAAO,CAACuC,SAAR,CAAkBgF,IADxE,CAEE,SAFF,CAGEvH,CAAO,CAACwC,OAAR,CAAgB6E,KAHlB,CAGwBrH,CAAO,CAACwC,OAAR,CAAgB8E,IAHxC,CAG6C,IAH7C,CAGkDtH,CAAO,CAACwC,OAAR,CAAgB+E,IAHlE,CAIE,YAJF,CAIeH,CAPN,CAApB,EAUGtB,IAVH,CAUQ,SAASC,CAAT,CAAgB,CAEpBA,CAAK,CAACG,iBAAN,CAAwB,cAAxB,EAEA,GAAIpE,CAAAA,CAAI,CAAGiE,CAAK,CAACI,OAAN,EAAX,CACArE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACuG,MAApB,CAA4B,UAAU,CAClCoB,CAAa,CAACd,CAAD,CAAaG,CAAb,IAChB,CAFD,EAIA/E,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACwG,IAApB,CAA0B,SAAStD,CAAT,CAAW,CACjC,GAAG,CAAC0E,CAAQ,EAAZ,CAAe,CACX1E,CAAC,CAACwD,cAAF,EACH,CAFD,IAEK,CACDiB,CAAa,CAACd,CAAD,CAAaG,CAAb,IAChB,CACJ,CAND,EASA/E,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACmH,MAApB,CAA4B,UAAU,CAElCxH,CAAC,CAAEe,CAAS,CAACM,SAAZ,CAAD,CAAwBoG,MAAxB,GACAzH,CAAC,CAAEe,CAAS,CAACK,WAAZ,CAAD,CAA0BqG,MAA1B,GACAzH,CAAC,CAAEe,CAAS,CAACkB,SAAZ,CAAD,CAAwBwF,MAAxB,GACAzH,CAAC,CAAEe,CAAS,CAACmB,OAAZ,CAAD,CAAsBuF,MAAtB,EACH,CAND,EAOAlB,CAAK,CAACU,IAAN,EACH,CApCD,EAoCG3C,IApCH,CAoCQ,UAAW,CAEftE,CAAC,CAAC,gCAAD,CAAD,CAAkCgH,IAAlC,CAAuC,aAAvC,EACAhH,CAAC,CAAC,gCAAD,CAAD,CAAkCgH,IAAlC,CAAuC,aAAvC,EAHe,GAKXjE,CAAAA,CAAS,CAAG,CAAC,KAAS,GAAImF,CAAAA,IAAJ,EAAD,CAAaC,WAAb,EAAT,CAAqC,IAAQ,GAAID,CAAAA,IAAJ,EAAD,CAAaE,QAAb,EAA5C,CAAoE,KAAQ,GAAIF,CAAAA,IAAJ,EAAD,CAAaG,OAAb,EAA3E,CALD,CAMXrF,CAAO,CAAG,CAAC,KAAS,GAAIkF,CAAAA,IAAJ,EAAD,CAAaC,WAAb,GAA4B,CAArC,CAAwC,IAAQ,GAAID,CAAAA,IAAJ,EAAD,CAAaE,QAAb,EAA/C,CAAuE,KAAQ,GAAIF,CAAAA,IAAJ,EAAD,CAAaG,OAAb,EAA9E,CANC,CAQfC,MAAM,CAACnD,IAAP,CAAYxE,CAAZ,CAA4B,SAAS4H,CAAT,CAAgBC,CAAhB,CAAsB,CAC9C,GAAGD,CAAK,EAAI7H,CAAZ,CAAsB,IACd+H,CAAAA,CAAS,CAAGD,CAAI,CAACzF,SAAL,CAAe2F,KAAf,CAAqB,GAArB,CADE,CAEdC,CAAO,CAAGH,CAAI,CAACxF,OAAL,CAAa0F,KAAb,CAAmB,GAAnB,CAFI,CAIlB3F,CAAS,CAAG,CAAC,KAAQ0F,CAAS,CAAC,CAAD,CAAlB,CAAuB,IAAOA,CAAS,CAAC,CAAD,CAAvC,CAA2C,KAAOA,CAAS,CAAC,CAAD,CAA3D,CAAZ,CACAzF,CAAO,CAAG,CAAC,KAAQ2F,CAAO,CAAC,CAAD,CAAhB,CAAqB,IAAOA,CAAO,CAAC,CAAD,CAAnC,CAAuC,KAAOA,CAAO,CAAC,CAAD,CAArD,CACb,CACJ,CARD,EAUArI,CAAgB,CAACsI,mBAAjB,CAAqC7F,CAArC,CAA+CC,CAA/C,EACA1C,CAAgB,CAACuI,0BAAjB,CAA4CpI,CAA5C,CAEH,CAzDD,EAP2B,wCAAH,uDA/Q0I,CAsVlKwH,CAAQ,CAAG,UAAW,IAElBa,CAAAA,CAAQ,CAAG9I,CAAC,CAACe,CAAS,CAACO,QAAX,CAAD,CAAsByH,GAAtB,EAFO,CAGlBC,CAAU,CAAGhJ,CAAC,CAACe,CAAS,CAACQ,UAAX,CAAD,CAAwBwH,GAAxB,EAHK,CAIlBE,CAAS,CAAGjJ,CAAC,CAACe,CAAS,CAACS,SAAX,CAAD,CAAuBuH,GAAvB,EAJM,CAKlBG,CAAO,CAAGlJ,CAAC,CAACe,CAAS,CAACc,OAAX,CAAD,CAAqBkH,GAArB,EALQ,CAMlBI,CAAM,CAAGnJ,CAAC,CAACe,CAAS,CAACY,MAAX,CAAD,CAAoBoH,GAApB,EANS,CAOlBK,CAAQ,CAAGpJ,CAAC,CAACe,CAAS,CAACa,QAAX,CAAD,CAAsBmH,GAAtB,EAPO,CASlBM,CAAI,GATc,CAWlBtG,CAAS,CAAG,GAAImF,CAAAA,IAAJ,CAASe,CAAS,CAAC,GAAV,CAAcD,CAAd,CAAyB,GAAzB,CAA6BF,CAAtC,EAAgDQ,OAAhD,GAA0D,GAXpD,CAYlBtG,CAAO,CAAG,GAAIkF,CAAAA,IAAJ,CAASgB,CAAO,CAAC,GAAR,CAAYE,CAAZ,CAAqB,GAArB,CAAyBD,CAAlC,EAA0CG,OAA1C,GAAoD,GAZ5C,CActB,GAAGtG,CAAO,CAAGD,CAAV,EAAuB/C,CAAC,CAACe,CAAS,CAACiB,SAAX,CAAD,CAAuBuH,EAAvB,CAA0B,UAA1B,CAA1B,CAAiE,CAC7DvJ,CAAC,CAACe,CAAS,CAACkB,SAAX,CAAD,CAAuB+E,IAAvB,CAA4B,8CAA5B,EACAhH,CAAC,CAACe,CAAS,CAACkB,SAAX,CAAD,CAAuB8B,IAAvB,CAA4B,SAA5B,CAAuC,OAAvC,EACA/D,CAAC,CAACe,CAAS,CAACkB,SAAX,CAAD,CAAuBgF,IAAvB,GACAoC,CAAI,GACP,CALD,IAKK,CACDrJ,CAAC,CAACe,CAAS,CAACkB,SAAX,CAAD,CAAuB+E,IAAvB,CAA4B,EAA5B,EACAhH,CAAC,CAACe,CAAS,CAACmB,OAAX,CAAD,CAAqB8E,IAArB,CAA0B,EAA1B,CACH,CAED,MAAOqC,CAAAA,CACV,CA/WqK,CAoXlKrB,CAAa,CAAG,SAASd,CAAT,CAAsBG,CAAtB,CAAkCmC,CAAlC,CAA8C,CAG9D,GAAI,CAAChJ,CAAO,CAACoC,EAAb,CAAiB,CACb,MACH,CAED,GAAG4G,CAAH,CAAc,IACNzG,CAAAA,CAAS,CAAGvC,CAAO,CAACuC,SAAR,CAAkB+E,IAAlB,CAAuB,GAAvB,CAA2BtH,CAAO,CAACuC,SAAR,CAAkB0G,GAA7C,CAAiD,GAAjD,CAAqDjJ,CAAO,CAACuC,SAAR,CAAkBgF,IAAvE,CAA4E,GAA5E,CAAgFvH,CAAO,CAACuC,SAAR,CAAkB2G,KAAlG,CAAwG,GAAxG,CAA4GlJ,CAAO,CAACuC,SAAR,CAAkB4G,OADpI,CAEN3G,CAAO,CAAGxC,CAAO,CAACwC,OAAR,CAAgB8E,IAAhB,CAAqB,GAArB,CAAyBtH,CAAO,CAACwC,OAAR,CAAgByG,GAAzC,CAA6C,GAA7C,CAAiDjJ,CAAO,CAACwC,OAAR,CAAgB+E,IAAjE,CAAsE,GAAtE,CAA0EvH,CAAO,CAACwC,OAAR,CAAgB0G,KAA1F,CAAgG,GAAhG,CAAoGlJ,CAAO,CAACwC,OAAR,CAAgB2G,OACrI,CAHD,IAGK,IACGb,CAAAA,CAAQ,CAAG9I,CAAC,CAACe,CAAS,CAACO,QAAX,CAAD,CAAsByH,GAAtB,EADd,CAEGC,CAAU,CAAGhJ,CAAC,CAACe,CAAS,CAACQ,UAAX,CAAD,CAAwBwH,GAAxB,EAFhB,CAGGE,CAAS,CAAGjJ,CAAC,CAACe,CAAS,CAACS,SAAX,CAAD,CAAuBuH,GAAvB,EAHf,CAIGa,CAAS,CAAG5J,CAAC,CAACe,CAAS,CAACU,SAAX,CAAD,CAAuBsH,GAAvB,EAJf,CAKGc,CAAW,CAAG7J,CAAC,CAACe,CAAS,CAACW,WAAX,CAAD,CAAyBqH,GAAzB,EALjB,CAMGhG,CAAS,CAAG+F,CAAQ,CAAC,GAAT,CAAaE,CAAb,CAAwB,GAAxB,CAA4BC,CAA5B,CAAsC,GAAtC,CAA0CW,CAA1C,CAAoD,GAApD,CAAwDC,CANvE,CAQG7G,CAAO,CAAG,GARb,CASD,GAAGhD,CAAC,CAACe,CAAS,CAACiB,SAAX,CAAD,CAAuBuH,EAAvB,CAA0B,UAA1B,CAAH,CAA0C,IAClCJ,CAAAA,CAAM,CAAGnJ,CAAC,CAACe,CAAS,CAACY,MAAX,CAAD,CAAoBoH,GAApB,EADyB,CAElCK,CAAQ,CAAEpJ,CAAC,CAACe,CAAS,CAACa,QAAX,CAAD,CAAsBmH,GAAtB,EAFwB,CAGlCG,CAAO,CAAGlJ,CAAC,CAACe,CAAS,CAACc,OAAX,CAAD,CAAqBkH,GAArB,EAHwB,CAIlCe,CAAO,CAAG9J,CAAC,CAACe,CAAS,CAACe,OAAX,CAAD,CAAqBiH,GAArB,EAJwB,CAKlCgB,CAAS,CAAG/J,CAAC,CAACe,CAAS,CAACgB,SAAX,CAAD,CAAuBgH,GAAvB,EALsB,CAMtC/F,CAAO,CAAGmG,CAAM,CAAC,GAAP,CAAWC,CAAX,CAAoB,GAApB,CAAwBF,CAAxB,CAAgC,GAAhC,CAAoCY,CAApC,CAA4C,GAA5C,CAAgDC,CAC7D,CACJ,CACD,GAAiB,EAAd,EAAA1C,CAAU,EAAU,IAAAA,CAAvB,CAA2C,CACvCA,CAAU,CAAG,CAChB,CAFD,IAEK,CACDA,CAAU,CAAG,CAChB,CAhC6D,GAmC1DrD,CAAAA,CAAI,CAAG,CACPC,QAAQ,CAAEzD,CAAO,CAACoC,EADX,CAEPsB,QAAQ,CAAExD,CAFH,CAGPsJ,IAAI,CAAE9C,CAHC,CAIPG,UAAU,CAAEA,CAJL,CAKPtE,SAAS,CAAEA,CALJ,CAMPC,OAAO,CAAEA,CANF,CAnCmD,CA6C1DiH,CAAQ,CAAG,CACX5F,UAAU,CAAE,gDADD,CAEXL,IAAI,CAAEA,CAFK,CAGXS,IAAI,CAAEvE,CAAY,CAACwE,SAHR,CA7C+C,CAoD1DP,CAAO,CAAGlE,CAAI,CAACmE,IAAL,CAAU,CAAC6F,CAAD,CAAV,CApDgD,CAqD9D9F,CAAO,CAAC,CAAD,CAAP,CAAWG,IAAX,CAAgB,SAASC,CAAT,CAAmB,CAE/BnE,CAAY,CAAC0F,MAAb,CAAoB,CAChBK,KAAK,CAAE,WADS,CAEhBC,IAAI,CAAE,SAAS7B,CAAQ,CAAC2F,MAAlB,CAAyB,cAFf,CAApB,EAGG5D,IAHH,CAGQ,SAASC,CAAT,CAAgB,CACpBA,CAAK,CAACU,IAAN,GACA,GAAI3E,CAAAA,CAAI,CAAGiE,CAAK,CAACI,OAAN,EAAX,CAECrE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACmH,MAApB,CAA4B,UAAU,CACnC2C,QAAQ,CAACC,MAAT,EACF,CAFD,CAIJ,CAXD,CAYH,CAdD,EAcG3F,IAdH,CAcQ,UAAa,CACjBvE,CAAY,CAACwE,SAChB,CAhBD,CAiBH,CA1bqK,CAiclKZ,CAAmB,CAAG,SAASuG,CAAT,CAAkB,CAExCjK,CAAY,CAAC0F,MAAb,CAAoB,CAChBC,IAAI,CAAE3F,CAAY,CAAC4F,KAAb,CAAmBC,WADT,CAEhBE,KAAK,CAAE,kBAFS,CAGhBC,IAAI,CAAE,4EAHU,CAApB,EAIGE,IAJH,CAIQ,SAASC,CAAT,CAAgB,CAEpBA,CAAK,CAACG,iBAAN,CAAwB,QAAxB,EACA,GAAIpE,CAAAA,CAAI,CAAGiE,CAAK,CAACI,OAAN,EAAX,CACArE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACuG,MAApB,CAA4B,UAAU,CAErC,CAFD,EAGAtE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACwG,IAApB,CAA0B,UAAW,CACjCyD,CAAiB,CAACD,CAAD,CACpB,CAFD,EAGA9D,CAAK,CAACU,IAAN,EACH,CAfD,CAgBH,CAndqK,CA0dlKqD,CAAiB,CAAG,SAAS/G,CAAT,CAAY,IAE5B+B,CAAAA,CAAG,CAAG/B,CAAC,CAACQ,IAAF,CAAO,IAAP,EAAa2E,KAAb,CAAmB,GAAnB,CAFsB,CAK5B1E,CAAI,CAAG,CACPC,QAAQ,CAACqB,CAAG,CAAC,CAAD,CADL,CAEPpB,QAAQ,CAAExD,CAFH,CAGP4E,GAAG,CAAEA,CAAG,CAAC,CAAD,CAHD,CALqB,CAY5B2E,CAAQ,CAAG,CACX5F,UAAU,CAAE,kDADD,CAEXL,IAAI,CAAEA,CAFK,CAGXS,IAAI,CAAEvE,CAAY,CAACwE,SAHR,CAZiB,CAmB5BP,CAAO,CAAGlE,CAAI,CAACmE,IAAL,CAAU,CAAC6F,CAAD,CAAV,CAnBkB,CAoBhC9F,CAAO,CAAC,CAAD,CAAP,CAAWG,IAAX,CAAgB,SAASC,CAAT,CAAmB,CAE/BvE,CAAC,CAAE,iCAAF,CAAD,CAAoCuK,OAApC,CAA6C,OAA7C,EAEAnK,CAAY,CAAC0F,MAAb,CAAoB,CAChBK,KAAK,CAAE,WADS,CAEhBC,IAAI,CAAE,SAAS7B,CAAQ,CAAC2F,MAAlB,CAAyB,cAFf,CAApB,EAGG5D,IAHH,CAGQ,SAASC,CAAT,CAAgB,CACpBA,CAAK,CAACU,IAAN,GACA,GAAI3E,CAAAA,CAAI,CAAGiE,CAAK,CAACI,OAAN,EAAX,CAEArE,CAAI,CAACY,EAAL,CAAQ7C,CAAW,CAACmH,MAApB,CAA4B,UAAU,CAClC2C,QAAQ,CAACC,MAAT,EACF,CAFF,CAGH,CAVD,CAWH,CAfD,EAeG3F,IAfH,CAeQ,UAAa,CACjBvE,CAAY,CAACwE,SAChB,CAjBD,CAkBH,CAhgBqK,CA4gBtK,MAAO,CACH8F,IAAI,CANG,QAAPA,CAAAA,IAAO,CAASlI,CAAT,CAAeC,CAAf,CAAuBC,CAAvB,CAAqCC,CAArC,CAAiDC,CAAjD,CAA+DC,CAA/D,CAAwE,CAC/EN,CAAW,CAACC,CAAD,CAAOC,CAAP,CAAeC,CAAf,CAA6BC,CAA7B,CAAwCC,CAAxC,CAAsDC,CAAtD,CAAX,CACAM,CAAuB,EAC1B,CAEM,CAGV,CAhhBK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Responsible for:\n * creation of modals to change enrolment,\n * creation of date modal to update date for enrolment\n * performs ajax requests to enrol a banner section,\n * performs ajax requests to delete a banner enrolment\n * calls create and duplicate course library in event course has been used in a different semester\n *\n * @package    theme_urcourses_default\n * @author     Brooke Clary\n * \n */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str',\n    'core/modal_factory', 'core/modal_events','theme_urcourses_default/course_actions'], function($, ajax, notification, str, ModalFactory, ModalEvents,courseActionsLib) {\n\n    /** Container jquery object. */\n    var _root;\n    /** Course ID */\n    var _course;\n    var _element;\n    var _semester;\n    var _semesterdates;\n    var _categories;\n    var _templatelist;\n    var _homeurl;\n\n    /** Jquery selector strings. */\n    var SELECTORS = {\n        HEADER: '#page-header .header-body',\n        HEADER_TOP: \"#page-header .page-head\",\n        BTN_COURSEENROL: '#btn_courseenrol',\n        BTN_ENROLTERM: '.btn_enrolterm',\n        STARTHOLDER: '#course_tools_startholder',\n        ENDHOLDER: '#course_tools_endholder',\n        STARTDAY: '#course_tools_start_day',\n        STARTMONTH: '#course_tools_start_month',\n        STARTYEAR: '#course_tools_start_year',\n        STARTHOUR: '#course_tools_start_hour',\n        STARTMINUTE: '#course_tools_start_minute',\n        ENDDAY: '#course_tools_end_day',\n        ENDMONTH: '#course_tools_end_month',\n        ENDYEAR: '#course_tools_end_year',\n        ENDHOUR: '#course_tools_end_hour',\n        ENDMINUTE: '#course_tools_end_minute',\n        ENDENABLE: '#course_tools_enddate_enabled',\n        ERR_START: '#error_course_tools_start',\n        ERR_END: '#error_course_tools_end',\n    };\n    const TEMPLATES = {\n        MODAL_COURSE_ACTION_CONTENT: 'theme_urcourses_default/modal_course_action_date'\n    };\n\n    /**\n     * Initializes global variables.\n     * @param {string} root - Jquery selector for container.\n     * @param {int} headerstyle - selected header style.\n     * @param {int} courseid - ID of current course.\n     * @return void\n     */\n    var _setGlobals = function(root, course,semesterdates,categories,templatelist,homeurl) {\n       _root = $(root);\n       _course = course;\n       _semesterdates = semesterdates;\n       _categories = categories;\n       _templatelist = templatelist;\n       _homeurl = homeurl;\n\n       //constructor for current course, incase of duplication, creation, or date modals being needed\n       courseActionsLib = new courseActionsLib(_course.id,_course.coursename, _course.shortname, _course.startdate, _course.enddate, _templatelist,_categories);\n    };\n\n    /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerEventListeners = function() {\n        _root.on('click', SELECTORS.BTN_ENROLTERM, _getEnrolInfo);\n    };\n     /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerSelectorEventListeners = function(_element) {\n        //set event listners for template options\n        $('.tmpl-label').bind('click', function() { _setActiveTemplate($(this)) } );   \n    } \n    /**\n    * Switch choosen template based on click in template list\n    */\n   var _setActiveTemplate = function(e) {\n\n        templateHolder = $('div[data-role=\"templateholder\"');\n        //on click check if already active\n        if(e.hasClass(\"active\")){\n            //remove active class\n            e.removeClass(\"active\");\n            //and uncheck checkbox\n            e.find(\".fa-check-square-o\").addClass(\"fa-square-o\");\n            e.find(\".fa-square-o\").removeClass(\"fa-check-square-o\");\n        }else{\n            //add active class\n            e.addClass(\"active\");\n            //and check checkbox\n            e.find(\".fa-square-o\").addClass(\"fa-check-square-o\");\n            e.find(\".fa-check-square-o\").removeClass(\"fa-square-o\");\n        }\n    };\n    \n    /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerDeleteButtons = function() {\n        //set event listners for template options\n        $('button[data-role=\"delete_button\"]').bind('click', function() { _deleteConfirmation($(this)); } );\n    }\n\n     /**\n     * Initiate ajax call to get enrollment info \n     * to create modal with choices\n     */\n    var _getEnrolInfo = function() {\n\n        _element = $(this);\n        _semester = _element.attr('id');\n\n        // return if required values aren't set\n        if (!_course.id) {\n            return;\n        }\n        // set args\n        var args = {\n            courseid: _course.id,\n            semester: _semester\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_enrollment_info',\n            args: args\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            _populateModal(response);\n        }).fail(function(ex) {\n            notification.exception;\n        });\t\n    }\n    \n    /**\n     * Handles ajax return and response to create modal with options\n     * @param {Object} response \n     */\n    var _populateModal = function(data) {\n\n        // create modal with current selection as header\n        var modaltitle = 'Modify enrolment for '+data.semester;\n            \n        activatedlist = \"\";\n        activatedtitle = \"\";\n        isavailable = data.isavaliable\n\n        templatelist = '<div class=\"form-control-feedback invalid-feedback\" id=\"error_course_tools_section\">'\n                        +'</div> <div data-role=\"templateholder\" class = \"list-group\" >';\n        //check if any data exists\n        if(data.courseinfo.length !=0){\n            //special selecting box\n            $.each( data.courseinfo, function( key, value ) {\n                templatelist += '<div data-role = \"bannerselect\" class=\"tmpl-label list-group-item list-group-item-action \" id = '+value.crn+'>'+\n                                '<h6><i class=\"fa fa-square-o\" aria-hidden=\"true\"></i>  '+\n                                value.subject + ' ' +value.course + '-' + value.section +'</h6>'+\n                                '</div>';\n            });\n            //add group division checkbox\n            templatelist += '<br><div class=\"form-check\">'\n                        +'<input class=\"form-check-input\" type=\"checkbox\" value=\"\" id=\"course_tools_groups\">'\n                        +'<label class=\"form-check-label\" for=\"course_tools_groups\">'\n                        +' Create groups for each section'\n                        +' </label>'\n                        +' </div>';\n        }else{\n            // else not error message\n            //add default template option even if there is no template category\n            templatelist += '<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action active\" id = \"0\" >'+\n                '<p>There are no available Banner Sections for this course </p>'+\n                '</div>';\n        }\n\n        //For banner sections already enrolled in current semester\n        if(data.activated.length !=0){\n            activatedtitle = \"<small>The following Banner sections are already enrolled for the selected term:</small>\";\n            activatedlist += '<div class=\"list-group\">';\n            $.each( data.activated, function( key, value ) {\n                var linkedClass = \"alert-warning\";\n                if(value.linked){\n                    linkedClass = \"alert-success\";\n                }\n\n                activatedlist +='<div class=\"list-group-item list-group-item-secondary '+linkedClass+'\">'+\n                                '<button data-role=\"delete_button\" type=\"button\" class=\"btn btn-primary float-right\" id=\"delete_'+value.crn+'_'+value.urid+'\">Delete Enrolment</button>'+\n                                '<h6>'+value.subject + ' ' +value.course + '-' + value.section + '<br>'+\n                                'enrolled into '+ value.fullname+'</h6>'+\n                                '</div>';\n                });\n                activatedlist += '</div><br>';\n        }\n        templatelist += '</div>';\n        \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: (data.courseinfo.length != 0) ? ModalFactory.types.SAVE_CANCEL :ModalFactory.types.CANCEL,\n            title: modaltitle,\n            body: ((isavailable) ? \"<p><b>Are you sure you want to modify enrolment for this course?</b><br />\"\n                    + \"<small>The following CRNs are available for the selected term:</small>\"\n                    + templatelist\n                    +\"</br>\"\n                    + activatedtitle \n                    + activatedlist \n                    + \"</p>\" : output),\n        }).then(function(modal) {\n\n            modal.footer.prepend('<a type=\"button\" class=\"btn btn-primary justify-content-start mr-auto p-2\" href=\"'+_homeurl+'/blocks/urcourserequest\">See All Enrolments</a>');\n\n            if(isavailable && data.courseinfo.length != 0){\n                modal.setSaveButtonText('Save');\n                var root = modal.getRoot();\n                root.on(ModalEvents.cancel, function(){\n                    return;\n                });\n                    \n                root.on(ModalEvents.save, function(e){\n\n                    templateHolder = $('div[data-role=\"templateholder\"');\n                    selectedTemplates = $(templateHolder).find('.active');\n                    //no selected template error\n                    if(selectedTemplates.length <=0){\n                        e.preventDefault(); \n                        $(\"#error_course_tools_section\").text(\"Please select a banner section\");\n                        $(\"#error_course_tools_section\").attr(\"display\", \"block\");\n                        $(\"#error_course_tools_section\").show();\n                    }else{\n                        var templateids = [];\n                        for(var i = 0; i<selectedTemplates.length; i++){\n                            templateids.push( {\"crn\": $(selectedTemplates[i]).attr('id')});\n                        }\n                        var groupcheck = $(\"#course_tools_groups\").prop(\"checked\") \n                        _addEnrolmentDateConfirm(data.courseinfo, templateids, groupcheck); \n                    }   \n                });\n            }else{\n                var root = modal.getRoot();\n                root.on(ModalEvents.cancel, function(){\n                    return;\n                });\n            }\n            //remove modal on hide\n            root.on(ModalEvents.hidden, function(e){\n                //remove inputs otherwise duplicates are made causing id problems\n                $( \"div[data-role='templateholder']\" ).remove();\n            });\n            modal.show();\n        }).done(function(modal) {\n\n            \n            \n            if(isavailable){\n                if(data.courseinfo.length>0 ){\n                    _registerSelectorEventListeners(_element);\n                }else{\n                    $('button[data-action=\"cancel\"]').text(\"Close\");\n                }\n            }\n            if(data.activated.length !=0){\n                _registerDeleteButtons();\n            }\n        });\n    };\n\n    /**\n     * Handles ajax return and response to create modal with options\n     * @param {Object} response \n     */\n    var _addEnrolmentDateConfirm = async function(data, templateids,groupcheck) {\n\n        // create modal with current selection as header\n        var modaltitle = 'Would you like to change course dates?';\n        var template =  await self.render(TEMPLATES.MODAL_COURSE_ACTION_CONTENT);\n      \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modaltitle,\n            body: (\"<p><b>Current Course Dates:\"\n                    +_course.startdate.month+_course.startdate.mday+\", \"+_course.startdate.year\n                    +\" until \"\n                    +_course.enddate.month+_course.enddate.mday+\", \"+_course.enddate.year\n                    +\"</b><br />\"+template ),\n           \n\n        }).then(function(modal) {\n\n            modal.setSaveButtonText('Update Dates');\n\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                _addEnrolment(templateids,groupcheck,true); \n            });\n                    \n            root.on(ModalEvents.save, function(e){\n                if(!validate()){\n                    e.preventDefault();   \n                }else{\n                    _addEnrolment(templateids,groupcheck, false); \n                }     \n            });\n            \n            //remove modal on hide\n            root.on(ModalEvents.hidden, function(){\n                //remove inputs otherwise duplicates are made causing id problems\n                $( SELECTORS.ENDHOLDER).remove();\n                $( SELECTORS.STARTHOLDER).remove();\n                $( SELECTORS.ERR_START).remove();\n                $( SELECTORS.ERR_END).remove();\n            });\n            modal.show();\n        }).done(function() {\n\n            $('button[data-action=\"cancel\"]').text(\"Leave Dates\");\n            $('button[data-action=\"cancel\"]').text(\"Leave Dates\");\n            \n            var startdate = {\"year\": (new Date()).getFullYear(), \"mon\": (new Date()).getMonth(),\"mday\":(new Date()).getDate()};\n            var enddate = {\"year\": (new Date()).getFullYear() +1, \"mon\": (new Date()).getMonth(),\"mday\":(new Date()).getDate()};\n\n            jQuery.each(_semesterdates, function(index, item) {\n                if(index == _semester){\n                    var starttemp = item.startdate.split(\"-\");\n                    var endtemp = item.enddate.split(\"-\");\n\n                    startdate = {\"year\": starttemp[2], \"mon\": starttemp[1],\"mday\":starttemp[0]};\n                    enddate = {\"year\": endtemp[2], \"mon\": endtemp[1],\"mday\":endtemp[0]};\n                }\n            });\n            //add numbers to date selectors\n            courseActionsLib.populateDateSelects(startdate,enddate);  \n            courseActionsLib.registerDateEventListeners(_element);\n\n        });\n    };\n    /**\n     * For Enrolemnt date selectors\n     * Check if dates are valid \n     * Return bool \n     */\n    var validate = function() {\n\n        var startday = $(SELECTORS.STARTDAY).val();\n        var startmonth = $(SELECTORS.STARTMONTH).val();\n        var startyear = $(SELECTORS.STARTYEAR).val();\n        var endyear = $(SELECTORS.ENDYEAR).val();\n        var endday = $(SELECTORS.ENDDAY).val();\n        var endmonth = $(SELECTORS.ENDMONTH).val();\n   \n        var test =true; \n        \n        var startdate = new Date(startyear+\".\"+startmonth+\".\"+startday).getTime()/1000;\n        var enddate = new Date(endyear+\".\"+endmonth+\".\"+endday).getTime()/1000;\n      \n        if(enddate < startdate && $(SELECTORS.ENDENABLE).is(\":checked\") ){\n            $(SELECTORS.ERR_START).text(\"Course end date can not be before start date\");\n            $(SELECTORS.ERR_START).attr(\"display\", \"block\");\n            $(SELECTORS.ERR_START).show();\n            test = false;\n        }else{\n            $(SELECTORS.ERR_START).text(\"\");\n            $(SELECTORS.ERR_END).text(\"\");\n        }\n\n        return test;\n    }\n    \n    /**\n     * After modal info has been entered call ajax request\n     */\n    var _addEnrolment = function(templateids, groupcheck, isoriginal) {\n\n        // return if required values aren't set\n        if (!_course.id) {\n            return;\n        }\n\n        if(isoriginal){\n            var startdate = _course.startdate.mday+\"-\"+_course.startdate.mon+\"-\"+_course.startdate.year+\"-\"+_course.startdate.hours+\"-\"+_course.startdate.minutes;\n            var enddate = _course.enddate.mday+\"-\"+_course.enddate.mon+\"-\"+_course.enddate.year+\"-\"+_course.enddate.hours+\"-\"+_course.enddate.minutes;\n        }else{\n            var startday = $(SELECTORS.STARTDAY).val();\n            var startmonth = $(SELECTORS.STARTMONTH).val();\n            var startyear = $(SELECTORS.STARTYEAR).val();\n            var starthour = $(SELECTORS.STARTHOUR).val();\n            var startminute = $(SELECTORS.STARTMINUTE).val();\n            var startdate = startday+\"-\"+startmonth+\"-\"+startyear+\"-\"+starthour+\"-\"+startminute;\n\n            var enddate = \"0\";\n            if($(SELECTORS.ENDENABLE).is(\":checked\") ){\n                var endday = $(SELECTORS.ENDDAY).val();\n                var endmonth= $(SELECTORS.ENDMONTH).val();\n                var endyear = $(SELECTORS.ENDYEAR).val();\n                var endhour = $(SELECTORS.ENDHOUR).val();\n                var endminute = $(SELECTORS.ENDMINUTE).val();\n                enddate = endday+\"-\"+endmonth+\"-\"+endyear+\"-\"+endhour+\"-\"+endminute;\n            }\n        }\n        if(groupcheck == \"\" || groupcheck == false){\n            groupcheck = 0;\n        }else{\n            groupcheck = 1;\n        }\n\n        // set args\n        var args = {\n            courseid: _course.id,\n            semester: _semester,\n            crns: templateids, \n            groupcheck: groupcheck,   \n            startdate: startdate,\n            enddate: enddate\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_activate_course',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n                     \n            ModalFactory.create({\n                title: \"Response:\",\n                body: '<p><b>'+response.result+'</b><br></p>',\n            }).then(function(modal) {\n                modal.show();\n                var root = modal.getRoot();\n                 //remove modal on hide\n                 root.on(ModalEvents.hidden, function(){\n                    location.reload();\n                 });\n                \n            })\n        }).fail(function(ex) {\n            notification.exception;\n        });  \n    };\n    \n     /**\n     * If delete button has been clicked for an\n     * activated banner enrollment, call an ajax\n     * request to remove the selected enrolment\n     */\n    var _deleteConfirmation = function(element) {\n    \n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: \"Delete Enrolment\",\n            body: \"<p><b>Are you sure you want to delete enrolment for this course?</b><br />\",\n        }).then(function(modal) {\n\n            modal.setSaveButtonText('Delete');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });        \n            root.on(ModalEvents.save, function(e){\n                _deleteEnrollment(element);\n            });\n            modal.show();\n        });\n    };\n\n    /**\n     * If delete button has been clicked for an\n     * activated banner enrollment, call an ajax\n     * request to remove the selected enrolment\n     */\n    var _deleteEnrollment = function(e) {\n        \n        var crn = e.attr('id').split(\"_\");\n\n        // set args\n        var args = {\n            courseid:crn[2],\n            semester: _semester,\n            crn: crn[1], \n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_delete_enrollment',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            //close previous modal\n            $( 'button[data-action=\"cancel\"] ').trigger( \"click\" );\n            \n            ModalFactory.create({\n                title: \"Response:\",\n                body: '<p><b>'+response.result+'</b><br></p>',\n            }).then(function(modal) {\n                modal.show();\n                var root = modal.getRoot();\n                //remove modal on hide\n                root.on(ModalEvents.hidden, function(){\n                    location.reload();\n                 });\n            })\n        }).fail(function(ex) {\n            notification.exception;\n        });  \n    };\n\n    /**\n     * Entry point to module. Sets globals and registers event listeners.\n     * @param {String} root Jquery selector for container.\n     * @return void\n     */\n    var init = function(root, course, semesterdates,categories, templatelist, homeurl) {\n        _setGlobals(root, course, semesterdates,categories,templatelist, homeurl);\n        _registerEventListeners();\n    };\n\n    return {\n        init: init\n    };\n});"],"file":"course_enrolment.min.js"}