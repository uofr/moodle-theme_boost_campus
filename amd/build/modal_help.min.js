define ("theme_urcourses_default/modal_help",["jquery","core/modal","core/modal_registry","core/modal_events","core/key_codes","core/custom_interaction_events","core/notification","core/templates","theme_urcourses_default/modal_help_ajax"],function(a,b,c,d,e,f,g,h,i){var j=!1,k={SEARCH:"#modal_help_search",SEARCH_BUTTON:"#modal_help_search_btn",SUGGESTIONS:"#modal_help_search_suggestions",SUGGESTION_ITEM:".modal-help-suggestion-item"},l={MODAL_HELP_CONTENT:"theme_urcourses_default/modal_help_content",MODAL_HELP_TOPICS:"theme_urcourses_default/modal_help_topics"},m=function(a){b.call(this,a);this.searchBox=this.root.find(k.SEARCH);this.searchButton=this.root.find(k.SEARCH_BUTTON);this.suggestionBox=this.root.find(k.SUGGESTIONS);this.topicList=null};m.prototype=Object.create(b.prototype);m.prototype.constructor=m;m.TYPE="theme_urcourses_default-help";m.prototype.registerEventListeners=function(){var c=this;b.prototype.registerEventListeners.call(this);this.getRoot().on(d.shown,function(){i.getRemtlHelp().then(function(a){var b=h.render(l.MODAL_HELP_CONTENT,{html:a.html});c.setBody(b)}).catch(g.exception);if(null===c.topicList){i.getTopicList().then(function(a){c.topicList=a;return h.render(l.MODAL_HELP_TOPICS,{topics:a})}).then(function(a,b){h.replaceNodeContents(k.SUGGESTIONS,a,b)}).catch(g.exception)}});this.getRoot().on(d.hidden,function(){c.setBody("");c.searchBox.val("");c.suggestionBox.html("")});this.getModal().on("focus",k.SEARCH,function(){c.suggestionBox.removeClass("d-none")});this.getModal().on("input",k.SEARCH,function(){var a=c.searchBox.val(),b=RegExp(a.split("").join(".*"),"i"),d=[];c.suggestionBox.html("");if(!a.length){return}var e=!0,f=!1,g=void 0;try{for(var h=c.topicList[Symbol.iterator](),i;!(e=(i=h.next()).done);e=!0){var j=i.value,k=b.exec(j.title);if(k){d.push({text:j.title,url:j.url,length:k[0].length,start:k.index})}}}catch(a){f=!0;g=a}finally{try{if(!e&&null!=h.return){h.return()}}finally{if(f){throw g}}}d.sort(function(c,a){if(c.length<a.length){return-1}if(c.length>a.length){return 1}if(c.start<a.start){return-1}if(c.start>a.start){return 1}});for(var l=0,m=d;l<m.length;l++){var n=m[l],o="<span class=\"modal-help-suggestion-item\" data-url=\"".concat(n.url,"\" data-value=\"").concat(n.text,"\">").concat(n.text,"</span>");c.suggestionBox.append(o)}});this.getModal().on(f.events.activate,k.SUGGESTION_ITEM,function(b){a(k.SEARCH).val(a(b.target).attr("data-value"));a(k.SUGGESTIONS).html("");i.getGuidePage(a(b.target).attr("data-url")).then(function(a){var b=h.render(l.MODAL_HELP_CONTENT,{html:a.html});c.setBody(b)}).catch(g.exception)})};if(!j){c.register(m.TYPE,m,"theme_urcourses_default/modal_help");j=!0}return m});
//# sourceMappingURL=modal_help.min.js.map
