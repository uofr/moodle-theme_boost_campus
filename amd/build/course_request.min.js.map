{"version":3,"sources":["../src/course_request.js"],"names":["define","$","ajax","notification","str","ModalFactory","ModalEvents","_root","_courseid","_coursename","_shortname","_element","SELECTORS","HEADER","HEADER_TOP","BTN_COURSETOOLS","BTN_DUPLICATE","BTN_NEW","BTN_STUDENT","_setGlobals","root","courseid","coursename","shortname","templatelist","categories","_templatelist","_categories","_registerEventListeners","on","_coursereqAction","_createStudentAction","_registerSelectorEventListeners","attr","length","bind","_setActiveTemplate","modaltitle","modalaction","templatenew","each","key","value","id","fullname","summary","templatebase","name","templateduplicate","create","type","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","getRoot","cancel","save","e","_validate","preventDefault","_createCourse","_duplicateCourse","hidden","remove","show","done","val","templateHolder","find","removeClass","addClass","error_coursename","error_shortname","test","text","templateid","selectedTemplate","categoryid","args","ajaxCall","methodname","fail","exception","promise","call","response","error","info","url","window","location","href","username","getAttribute","_createStudentAccount","success","data","_createdAccount","action","created","enrolled","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Campus - Code for course header image uploader.\n *\n * @package    theme_urcourses_default\n * @author     John Lane\n * \n */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str',\n    'core/modal_factory', 'core/modal_events'], function($, ajax, notification, str, ModalFactory, ModalEvents) {\n\n    /** Container jquery object. */\n    var _root;\n    /** Course ID */\n    var _courseid;\n    var _coursename;\n    var _shortname;\n    var _element;\n\n    /** Jquery selector strings. */\n    var SELECTORS = {\n        HEADER: '#page-header .header-body',\n        HEADER_TOP: \"#page-header .page-head\",\n        BTN_COURSETOOLS: '#btn_coursetools',\n        BTN_DUPLICATE: '#btn_duplicate',\n        BTN_NEW: '#btn_new',\n        BTN_STUDENT: '#btn_student',\n    };\n\n    /**\n     * Initializes global variables.\n     * @param {string} root - Jquery selector for container.\n     * @param {int} headerstyle - selected header style.\n     * @param {int} courseid - ID of current course.\n     * @return void\n     */\n    var _setGlobals = function(root, courseid,coursename,shortname,templatelist, categories) {\n       _root = $(root);\n       _courseid = courseid;\n       _templatelist = templatelist;\n       _categories = categories;\n       _coursename = coursename;\n       _shortname = shortname;\n    };\n\n    /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerEventListeners = function() {\n\n       \n        _root.on('click', SELECTORS.BTN_COURSETOOLS, _coursereqAction);\n        _root.on('click', SELECTORS.BTN_DUPLICATE, _coursereqAction);\n        _root.on('click', SELECTORS.BTN_NEW, _coursereqAction);\n        _root.on('click', SELECTORS.BTN_STUDENT, _createStudentAction);\n    };\n\n     /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerSelectorEventListeners = function(_element) {\n        if(_element.attr('id') == 'btn_new' && _templatelist.length<=6){\n            //set event listners for template options\n            $('.tmpl-label').bind('click', function() { _setActiveTemplate($(this)); } );\n        }\n    };\n\n    /**\n     * Used for new course and duplicate course creation on button clicks\n     */\n    var _coursereqAction = function() {\n\n        _element = $(this);\n\n        var modaltitle = (_element.attr('id') == 'btn_new') ? 'Create new course' : 'Duplicate this course';\n        var modalaction = (_element.attr('id') == 'btn_new') ? 'create a new' : 'duplicate this';\n            \n        templatenew = '<div data-role=\"templateholder\" class = \"list-group\" >';\n        if(_templatelist !=0){\n\n            if(_templatelist.length>6){\n\n                templatenew += '<label  class=\"col-form-label d-inline \" for=\"templateselect\">Template Select:</label><br> ';\n                templatenew += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_templateselect\"></div> ';\n                templatenew += '<select class=\"custom-select\" id=\"templateselect\" ';\n           \n                templatenew += '<option value = 0 > Default Blank Course</option>';\n                templatenew += '<option value = 0 > Default Blank Course</option>';\n                $.each( _templatelist, function( key, value ) {\n                    templatenew += '<option value = '+value.id+'>'+value.fullname +'</option>';\n                });\n                templatenew += '</select>';\n\n            }else{\n                $.each( _templatelist, function( key, value ) {\n                    templatenew += '<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action \" id = '+value.id+'>'+\n                                    '<h6>'+value.fullname +'</h6>'+\n                                    '<p><small>'+value.summary+'</small></p>'+\n                                    '</div>';\n                });\n\n                //add default template option even if there is no template category\n                templatenew += '<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action active\" id = \"0\" >'+\n                '<h6>Default Course</h6>'+\n                '<p><small>Basic course template. No activites included </small></p>'+\n                '</div>';\n            }\n        }else{\n\n            //add default template option even if there is no template category\n            templatenew += '<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action active\" id = \"0\" >'+\n            '<h6>Default Course</h6>'+\n            '<p><small>Basic course template. No activites included </small></p>'+\n            '</div>';\n        }\n        templatebase = '</div>';\n        templatebase += '<br><br>';\n        templatebase += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_coursename\"></div> ';\n        templatebase += '<label  class=\"col-form-label d-inline \" for=\"coursename\">Course Full Name:</label>'+\n            '<input maxlength=\"254\" class=\"form-control \" type=\"text\" id=\"coursename\" name=\"coursename\"><br> ';\n        templatebase += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_shortname\"></div> ';\n        templatebase += '<label class=\"col-form-label d-inline \" for=\"shortname\">Course Short Name:</label>'+\n            '<input maxlength=\"254\" class=\"form-control \" type=\"text\" id=\"shortname\" name=\"shortname\"><br> ';\n\n\n        templatebase += '<label  class=\"col-form-label d-inline \" for=\"category\">Course Category:</label><br> ';\n        templatebase += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_category\"></div> ';\n        templatebase += '<select class=\"custom-select\" id=\"category\" ';\n        if(_categories !=0){\n            $.each( _categories, function( key, value ) {\n                templatebase += '<option value = '+value.id+'>'+value.name +'</option>';\n            });\n        }\n        templatebase += '</select';\n\n        templatenew += templatebase;  \n        templateduplicate = templatebase;\n        \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modaltitle,\n            body: \"<p><b>Are you sure you want to \"+ modalaction +\" course?</b><br />\"\n                + ((_element.attr('id') == 'btn_new') ? \"<small>Select from the templates below:</small>\" : \"<small>Student data will not be included in the duplicated course.</small>\")\n                + ((_element.attr('id') == 'btn_new') ? templatenew : '' )\n                + (!(_element.attr('id') == 'btn_new') ? templateduplicate : '' )\n                + \"</p>\"\n        }).then(function(modal) {\n\n            modal.setSaveButtonText((_element.attr('id') == 'btn_new') ? 'Create new course' : 'Duplicate this course');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n                \n            if((_element.attr('id') == 'btn_new')){\n                root.on(ModalEvents.save, function(e){\n                    if(!_validate()){\n                        e.preventDefault();   \n                    }else{\n                        _createCourse(_element.attr('id') );\n                    }    \n                });\n            }else{\n                root.on(ModalEvents.save, function(e){\n                    if(!_validate()){\n                        e.preventDefault();   \n                    }else{\n                        _duplicateCourse(_element.attr('id') );\n                    }\n                });\n            }\n            //remove modal on hide\n            root.on(ModalEvents.hidden, function(){\n                //remove inputs otherwise duplicates are made causing id problems\n                $( \"#coursename\" ).remove();\n                $( \"#shortname\" ).remove();\n                $( \"#category\" ).remove();\n            });\n\n            modal.show();\n        }).done(function() {\n            if((_element.attr('id') == 'btn_new')){\n                _registerSelectorEventListeners(_element);\n            }else{\n                 $('#coursename').val(_coursename+\" (Copy)\");\n                 $('#shortname').val(_shortname+\" (Copy)\");\n            }\n        });\n    };\n\n    /**\n     * Switch choosen template based on click in template list\n     */\n    var _setActiveTemplate = function(e) {\n\n        templateHolder = $('div[data-role=\"templateholder\"');\n        $(templateHolder).find('.active').removeClass(\"active\");\n        e.addClass(\"active\");\n    };\n\n    /**\n     * For Duplicate and Create course.\n     * Validate if course name and shortname have been entered\n     */\n    var _validate = function() {\n\n        coursename = $('#coursename').val();\n        shortname = $('#shortname').val();\n\n        error_coursename = $('#error_coursename');\n        error_shortname = $('#error_shortname');\n\n        var test =true; \n        if(coursename.length ==0){\n            $(error_coursename).text(\"Please enter a name for the course\");\n            $(error_coursename).attr(\"display\", \"block\");\n            $(error_coursename).show();\n            test = false;\n        }\n\n        if(shortname.length ==0){\n            $(error_shortname).text(\"Please enter a short name for the course\");\n            $(error_shortname).attr(\"display\", \"block\");\n            $(error_shortname).show();\n            test = false;\n        }\n\n        if(!test){\n            return false;\n        }\n        $(error_coursename).text(\"\");\n        $(error_shortname).text(\"\");\n        return true;\n    };\n\n    /**\n     * After modal info has been entered call ajax request\n     */\n    var _createCourse = function() {\n        \n        // return if required values aren't set\n        if (!_courseid) {\n            return;\n        }\n        \n        if(_templatelist.length>6){\n            templateid = $('#templateselect').val();\n        }else{\n            templateHolder = $('div[data-role=\"templateholder\"');\n            selectedTemplate = $(templateHolder).find('.active')\n            templateid = $(selectedTemplate).attr('id');\n        }\n\n        coursename = $('#coursename').val();\n        shortname = $('#shortname').val();\n        categoryid = $('#category').val();\n\n        //duplicate course option selected\n        // set args\n        var args = {\n            courseid: _courseid,\n            templateid: templateid,    \n            coursename: coursename,\n            shortname: shortname,\n            categoryid: categoryid,\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_create_course',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            if(response.error!=\"\"){\n\n                title = \"ERROR:\"\n                info = response.error;\n\n                ModalFactory.create({\n                    title: title,\n                    body: '<p><b>'+info+'</b><br></p>',\n                })\n                .done(function(modal) {\n                    modal.show();\n                });\n            }\n            //ADD REDIRECT TO NEW COURSE USING NEW ID\n            if(response.url !=\"\"){\n                window.location.href = response.url;\n            }\n        }).fail(function(ex) {\n            notification.exception;\n        });  \n    };\n\n     /**\n     * After modal info has been entered call ajax request\n     */\n    var _duplicateCourse = function() {\n        \n        // return if required values aren't set\n        if (!_courseid) {\n            return;\n        }\n        coursename = $('#coursename').val();\n        shortname = $('#shortname').val();\n        categoryid = $('#category').val();\n\n        //duplicate course option selected\n        // set args\n        var args = {\n            courseid: _courseid,\n            coursename: coursename,\n            shortname: shortname,\n            categoryid: categoryid,\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_duplicate_course',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            if(response.error!=\"\"){\n\n                title = \"ERROR:\"\n                info = response.error;\n\n                ModalFactory.create({\n                    title: title,\n                    body: '<p><b>'+info+'</b><br></p>',\n                })\n                .done(function(modal) {\n                    modal.show();\n                });\n            }\n            //ADD REDIRECT TO NEW COURSE USING NEW ID\n            if(response.url !=\"\"){\n                window.location.href = response.url;\n            }\n        }).fail(function() {\n            notification.exception;\n        });  \n    };\n\n     /**\n     * Modal after button click to create student account\n     */\n    var _createStudentAction = function() {\n\n        var username =this.getAttribute(\"aria-username\");\n        var modaltitle = 'Create and enroll test student account in course';\n        var modalaction = 'create the test student account '+username+'+student@uregina.ca';\n\t\t\n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modaltitle,\n            body: \"<p><b>Do you want to \"+ modalaction +\"?</b><br /></p>\"\n        })\n        .then(function(modal) {\n            \n            modal.setSaveButtonText('Create');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n\n            root.on(ModalEvents.save, function(){\n                _createStudentAccount(username)\n            });\n\n            modal.show();\n        });\n    };\n\n     /**\n     * After modal info has been entered call ajax request\n     */\n    var _createStudentAccount = function(username) {\n\n        // return if required values aren't set\n        if (!_courseid) {\n            return;\n        }\n\n        // set args\n        var args = {\n            courseid: _courseid,\n            username: username\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_create_test_account',\n            args: args,\n            success: function (data) { \n                _createdAccount(data);\n            },\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            _createdAccount(response);\n        }).fail(function(ex) {\n            notification.exception;\n        });\t\n    };\n    /**\n     * Handles ajax return and response to return data\n     * @param {Object} response \n     */\n    var _createdAccount = function(data) {\n    \n        //create new modal\n        title = \"Success: \";\n        info=\"\";\n        action=\" Would you like to logout, inorder to login to new account?\";\n\n        //if both actions were done\n        if(data.created != false && data.enrolled !=false){\n            info =data.username+\" was created and enrolled into this course. Login password is the same as current account.\";\n        }else if(data.created != false && data.enrolled ==false ){\n            info = data.username+\" was created, but FAILED to be enrolled into this course\";\n        }else if(data.created == false && data.enrolled !=false ){\n            info = data.username+\" already existed, and has now been enrolled into this course. Login password is the same as current account.\";\n        }else{\n            title = \"ERROR:\"\n            info = data.username+\" already exists and is enrolled into the course\";\n\n            ModalFactory.create({\n                title: title,\n                body: '<p><b>'+info+'</b><br></p>',\n              })\n              .done(function(modal) {\n                modal.show();\n              });\n              \n            return;\n        }\n        \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: \"<p><b>\"+ info +\"</b><br>\"+action+\"<br /></p>\"\n        })\n        .then(function(modal) {\n            \n            modal.setSaveButtonText('Logout');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n\n            root.on(ModalEvents.save, function(){\n                var href = $('a[data-title=\"logout,moodle\"]').attr('href');\n                window.location.href = href;\n                $(\"#username\").value= data.username;      \n            });\n            modal.show();\n        });\n    };\n\n    /**\n     * Entry point to module. Sets globals and registers event listeners.\n     * @param {String} root Jquery selector for container.\n     * @return void\n     */\n    var init = function(root, courseid, templatelist, categories,coursename,shortname) {\n        _setGlobals(root, courseid,coursename, shortname, templatelist,categories);\n        _registerEventListeners();\n    };\n\n    return {\n        init: init\n    };\n\n});"],"file":"course_request.min.js"}