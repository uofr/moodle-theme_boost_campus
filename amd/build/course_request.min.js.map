{"version":3,"sources":["../src/course_request.js"],"names":["define","$","ajax","notification","str","ModalFactory","ModalEvents","_root","_courseid","_coursename","_shortname","_element","SELECTORS","HEADER","HEADER_TOP","BTN_COURSETOOLS","BTN_DUPLICATE","BTN_NEW","BTN_STUDENT","BTN_DESCRIPTION","_setGlobals","root","courseid","coursename","shortname","templatelist","categories","_templatelist","_categories","_registerEventListeners","on","_coursereqAction","_createStudentAction","_editCourseDescription","_registerSelectorEventListeners","attr","length","bind","_setActiveTemplate","modaltitle","modalaction","templatenew","each","key","value","id","fullname","summary","templatebase","name","templateduplicate","create","type","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","getRoot","cancel","save","e","_validate","preventDefault","_createCourse","_duplicateCourse","hidden","remove","show","done","val","templateHolder","find","removeClass","addClass","error_coursename","error_shortname","test","text","templateid","selectedTemplate","categoryid","args","ajaxCall","methodname","fail","exception","promise","call","response","error","info","url","window","location","href","username","getAttribute","_createStudentAccount","success","data","_createdAccount","action","created","enrolled","origin","substring","lastIndexOf","target","_checkCourseEdit","indexOf","hash","navHeight","outerHeight","animate","scrollTop","offset","top","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Campus - Code for course header image uploader.\n *\n * @package    theme_urcourses_default\n * @author     John Lane\n * \n */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str',\n    'core/modal_factory', 'core/modal_events'], function($, ajax, notification, str, ModalFactory, ModalEvents) {\n\n    /** Container jquery object. */\n    var _root;\n    /** Course ID */\n    var _courseid;\n    var _coursename;\n    var _shortname;\n    var _element;\n\n    /** Jquery selector strings. */\n    var SELECTORS = {\n        HEADER: '#page-header .header-body',\n        HEADER_TOP: \"#page-header .page-head\",\n        BTN_COURSETOOLS: '#btn_coursetools',\n        BTN_DUPLICATE: '#btn_duplicate',\n        BTN_NEW: '#btn_new',\n        BTN_STUDENT: '#btn_student',\n        BTN_DESCRIPTION: '#btn_editdescription',\n    };\n\n    /**\n     * Initializes global variables.\n     * @param {string} root - Jquery selector for container.\n     * @param {int} headerstyle - selected header style.\n     * @param {int} courseid - ID of current course.\n     * @return void\n     */\n    var _setGlobals = function(root, courseid,coursename,shortname,templatelist, categories) {\n       _root = $(root);\n       _courseid = courseid;\n       _templatelist = templatelist;\n       _categories = categories;\n       _coursename = coursename;\n       _shortname = shortname;\n    };\n\n    /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerEventListeners = function() {\n\n       \n        _root.on('click', SELECTORS.BTN_COURSETOOLS, _coursereqAction);\n        _root.on('click', SELECTORS.BTN_DUPLICATE, _coursereqAction);\n        _root.on('click', SELECTORS.BTN_NEW, _coursereqAction);\n        _root.on('click', SELECTORS.BTN_STUDENT, _createStudentAction);\n        _root.on('click', SELECTORS.BTN_DESCRIPTION, _editCourseDescription);\n    };\n\n     /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerSelectorEventListeners = function(_element) {\n        if(_element.attr('id') == 'btn_new' && _templatelist.length<=6){\n            //set event listners for template options\n            $('.tmpl-label').bind('click', function() { _setActiveTemplate($(this)); } );\n        }\n    };\n\n    /**\n     * Used for new course and duplicate course creation on button clicks\n     */\n    var _coursereqAction = function() {\n\n        _element = $(this);\n\n        var modaltitle = (_element.attr('id') == 'btn_new') ? 'Create new course' : 'Duplicate this course';\n        var modalaction = (_element.attr('id') == 'btn_new') ? 'create a new' : 'duplicate this';\n            \n        templatenew = '<div data-role=\"templateholder\" class = \"list-group\" >';\n        if(_templatelist !=0){\n\n            if(_templatelist.length>6){\n\n                templatenew += '<label  class=\"col-form-label d-inline \" for=\"templateselect\">Template Select:</label><br> ';\n                templatenew += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_templateselect\"></div> ';\n                templatenew += '<select class=\"custom-select\" id=\"templateselect\" ';\n           \n                templatenew += '<option value = 0 > Default Blank Course</option>';\n                templatenew += '<option value = 0 > Default Blank Course</option>';\n                $.each( _templatelist, function( key, value ) {\n                    templatenew += '<option value = '+value.id+'>'+value.fullname +'</option>';\n                });\n                templatenew += '</select>';\n\n            }else{\n                $.each( _templatelist, function( key, value ) {\n                    templatenew += '<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action \" id = '+value.id+'>'+\n                                    '<h6>'+value.fullname +'</h6>'+\n                                    '<p><small>'+value.summary+'</small></p>'+\n                                    '</div>';\n                });\n\n                //add default template option even if there is no template category\n                templatenew += '<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action active\" id = \"0\" >'+\n                '<h6>Default Course</h6>'+\n                '<p><small>Basic course template. No activites included </small></p>'+\n                '</div>';\n            }\n        }else{\n\n            //add default template option even if there is no template category\n            templatenew += '<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action active\" id = \"0\" >'+\n            '<h6>Default Course</h6>'+\n            '<p><small>Basic course template. No activites included </small></p>'+\n            '</div>';\n        }\n        templatebase = '</div>';\n        templatebase += '<br><br>';\n        templatebase += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_coursename\"></div> ';\n        templatebase += '<label  class=\"col-form-label d-inline \" for=\"coursename\">Course Full Name:</label>'+\n            '<input maxlength=\"254\" class=\"form-control \" type=\"text\" id=\"coursename\" name=\"coursename\"><br> ';\n        templatebase += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_shortname\"></div> ';\n        templatebase += '<label class=\"col-form-label d-inline \" for=\"shortname\">Course Short Name:</label>'+\n            '<input maxlength=\"254\" class=\"form-control \" type=\"text\" id=\"shortname\" name=\"shortname\"><br> ';\n\n\n        templatebase += '<label  class=\"col-form-label d-inline \" for=\"category\">Course Category:</label><br> ';\n        templatebase += '<div class=\"form-control-feedback invalid-feedback\" id=\"error_category\"></div> ';\n        templatebase += '<select class=\"custom-select\" id=\"category\" ';\n        if(_categories !=0){\n            $.each( _categories, function( key, value ) {\n                templatebase += '<option value = '+value.id+'>'+value.name +'</option>';\n            });\n        }\n        templatebase += '</select';\n\n        templatenew += templatebase;  \n        templateduplicate = templatebase;\n        \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modaltitle,\n            body: \"<p><b>Are you sure you want to \"+ modalaction +\" course?</b><br />\"\n                + ((_element.attr('id') == 'btn_new') ? \"<small>Select from the templates below:</small>\" : \"<small>Student data will not be included in the duplicated course.</small>\")\n                + ((_element.attr('id') == 'btn_new') ? templatenew : '' )\n                + (!(_element.attr('id') == 'btn_new') ? templateduplicate : '' )\n                + \"</p>\"\n        }).then(function(modal) {\n\n            modal.setSaveButtonText((_element.attr('id') == 'btn_new') ? 'Create new course' : 'Duplicate this course');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n                \n            if((_element.attr('id') == 'btn_new')){\n                root.on(ModalEvents.save, function(e){\n                    if(!_validate()){\n                        e.preventDefault();   \n                    }else{\n                        _createCourse(_element.attr('id') );\n                    }    \n                });\n            }else{\n                root.on(ModalEvents.save, function(e){\n                    if(!_validate()){\n                        e.preventDefault();   \n                    }else{\n                        _duplicateCourse(_element.attr('id') );\n                    }\n                });\n            }\n            //remove modal on hide\n            root.on(ModalEvents.hidden, function(){\n                //remove inputs otherwise duplicates are made causing id problems\n                $( \"#coursename\" ).remove();\n                $( \"#shortname\" ).remove();\n                $( \"#category\" ).remove();\n            });\n\n            modal.show();\n        }).done(function() {\n            if((_element.attr('id') == 'btn_new')){\n                _registerSelectorEventListeners(_element);\n            }else{\n                 $('#coursename').val(_coursename+\" (Copy)\");\n                 $('#shortname').val(_shortname+\" (Copy)\");\n            }\n        });\n    };\n\n    /**\n     * Switch choosen template based on click in template list\n     */\n    var _setActiveTemplate = function(e) {\n\n        templateHolder = $('div[data-role=\"templateholder\"');\n        $(templateHolder).find('.active').removeClass(\"active\");\n        e.addClass(\"active\");\n    };\n\n    /**\n     * For Duplicate and Create course.\n     * Validate if course name and shortname have been entered\n     */\n    var _validate = function() {\n\n        coursename = $('#coursename').val();\n        shortname = $('#shortname').val();\n\n        error_coursename = $('#error_coursename');\n        error_shortname = $('#error_shortname');\n\n        var test =true; \n        if(coursename.length ==0){\n            $(error_coursename).text(\"Please enter a name for the course\");\n            $(error_coursename).attr(\"display\", \"block\");\n            $(error_coursename).show();\n            test = false;\n        }\n\n        if(shortname.length ==0){\n            $(error_shortname).text(\"Please enter a short name for the course\");\n            $(error_shortname).attr(\"display\", \"block\");\n            $(error_shortname).show();\n            test = false;\n        }\n\n        if(!test){\n            return false;\n        }\n        $(error_coursename).text(\"\");\n        $(error_shortname).text(\"\");\n        return true;\n    };\n\n    /**\n     * After modal info has been entered call ajax request\n     */\n    var _createCourse = function() {\n        \n        // return if required values aren't set\n        if (!_courseid) {\n            return;\n        }\n        \n        if(_templatelist.length>6){\n            templateid = $('#templateselect').val();\n        }else{\n            templateHolder = $('div[data-role=\"templateholder\"');\n            selectedTemplate = $(templateHolder).find('.active')\n            templateid = $(selectedTemplate).attr('id');\n        }\n\n        coursename = $('#coursename').val();\n        shortname = $('#shortname').val();\n        categoryid = $('#category').val();\n\n        //duplicate course option selected\n        // set args\n        var args = {\n            courseid: _courseid,\n            templateid: templateid,    \n            coursename: coursename,\n            shortname: shortname,\n            categoryid: categoryid,\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_create_course',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            if(response.error!=\"\"){\n\n                title = \"ERROR:\"\n                info = response.error;\n\n                ModalFactory.create({\n                    title: title,\n                    body: '<p><b>'+info+'</b><br></p>',\n                })\n                .done(function(modal) {\n                    modal.show();\n                });\n            }\n            //ADD REDIRECT TO NEW COURSE USING NEW ID\n            if(response.url !=\"\"){\n                window.location.href = response.url;\n            }\n        }).fail(function(ex) {\n            notification.exception;\n        });  \n    };\n\n     /**\n     * After modal info has been entered call ajax request\n     */\n    var _duplicateCourse = function() {\n        \n        // return if required values aren't set\n        if (!_courseid) {\n            return;\n        }\n        coursename = $('#coursename').val();\n        shortname = $('#shortname').val();\n        categoryid = $('#category').val();\n\n        //duplicate course option selected\n        // set args\n        var args = {\n            courseid: _courseid,\n            coursename: coursename,\n            shortname: shortname,\n            categoryid: categoryid,\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_duplicate_course',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            if(response.error!=\"\"){\n\n                title = \"ERROR:\"\n                info = response.error;\n\n                ModalFactory.create({\n                    title: title,\n                    body: '<p><b>'+info+'</b><br></p>',\n                })\n                .done(function(modal) {\n                    modal.show();\n                });\n            }\n            //ADD REDIRECT TO NEW COURSE USING NEW ID\n            if(response.url !=\"\"){\n                window.location.href = response.url;\n            }\n        }).fail(function() {\n            notification.exception;\n        });  \n    };\n\n     /**\n     * Modal after button click to create student account\n     */\n    var _createStudentAction = function() {\n\n        var username =this.getAttribute(\"aria-username\");\n        var modaltitle = 'Create and enroll test student account in course';\n        var modalaction = 'create the test student account '+username+'+student@uregina.ca';\n\t\t\n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modaltitle,\n            body: \"<p><b>Do you want to \"+ modalaction +\"?</b><br /></p>\"\n        })\n        .then(function(modal) {\n            \n            modal.setSaveButtonText('Create');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n\n            root.on(ModalEvents.save, function(){\n                _createStudentAccount(username)\n            });\n\n            modal.show();\n        });\n    };\n\n     /**\n     * After modal info has been entered call ajax request\n     */\n    var _createStudentAccount = function(username) {\n\n        // return if required values aren't set\n        if (!_courseid) {\n            return;\n        }\n\n        // set args\n        var args = {\n            courseid: _courseid,\n            username: username\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_create_test_account',\n            args: args,\n            success: function (data) { \n                _createdAccount(data);\n            },\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            _createdAccount(response);\n        }).fail(function(ex) {\n            notification.exception;\n        });\t\n    };\n    /**\n     * Handles ajax return and response to return data\n     * @param {Object} response \n     */\n    var _createdAccount = function(data) {\n    \n        //create new modal\n        title = \"Success: \";\n        info=\"\";\n        action=\" Would you like to logout, inorder to login to new account?\";\n\n        //if both actions were done\n        if(data.created != false && data.enrolled !=false){\n            info =data.username+\" was created and enrolled into this course. Login password is the same as current account.\";\n        }else if(data.created != false && data.enrolled ==false ){\n            info = data.username+\" was created, but FAILED to be enrolled into this course\";\n        }else if(data.created == false && data.enrolled !=false ){\n            info = data.username+\" already existed, and has now been enrolled into this course. Login password is the same as current account.\";\n        }else{\n            title = \"ERROR:\"\n            info = data.username+\" already exists and is enrolled into the course\";\n\n            ModalFactory.create({\n                title: title,\n                body: '<p><b>'+info+'</b><br></p>',\n              })\n              .done(function(modal) {\n                modal.show();\n              });\n              \n            return;\n        }\n        \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: title,\n            body: \"<p><b>\"+ info +\"</b><br>\"+action+\"<br /></p>\"\n        })\n        .then(function(modal) {\n            \n            modal.setSaveButtonText('Logout');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n\n            root.on(ModalEvents.save, function(){\n                var href = $('a[data-title=\"logout,moodle\"]').attr('href');\n                window.location.href = href;\n                $(\"#username\").value= data.username;      \n            });\n            modal.show();\n        });\n    };\n\n     /**\n     * Link to course edit page to edit course description\n     */\n    var _editCourseDescription = function() {\n\n        var origin   = window.location.href;    \n         \n        origin =origin.substring(0,origin.lastIndexOf('/'));\n\n        var target = origin + \"/edit.php?id=\"+_courseid+\"#id_descriptionhdr\";\n\n        window.location.href = target;\n    };\n\n     /**\n     * Check if on course edit page and if hash has been added to url\n     */\n    var _checkCourseEdit = function() {\n\n        var origin   = window.location.href;     \n\n        if (origin.indexOf(\"course/edit.php\") >= 0){\n         \n            if(window.location.hash != \"\"){\n                var navHeight = $('.navbar').outerHeight();\n                $('html, body').animate({\n                    scrollTop: $(window.location.hash).offset().top - navHeight\n                }, 2000);\n            }\n        }\n    };\n\n\n    /**\n     * Entry point to module. Sets globals and registers event listeners.\n     * @param {String} root Jquery selector for container.\n     * @return void\n     */\n    var init = function(root, courseid, templatelist, categories,coursename,shortname) {\n        _setGlobals(root, courseid,coursename, shortname, templatelist,categories);\n        _registerEventListeners();\n\n        //little hacky way to use a scroll jump on course edit page without editing course edit\n        _checkCourseEdit();\n    };\n\n    return {\n        init: init\n    };\n\n});"],"file":"course_request.min.js"}