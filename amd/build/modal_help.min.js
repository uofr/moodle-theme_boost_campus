define ("theme_urcourses_default/modal_help",["jquery","core/modal","core/modal_registry","core/modal_events","core/key_codes","core/custom_interaction_events","core/notification","core/templates","theme_urcourses_default/modal_help_ajax"],function(a,b,c,d,f,g,h,i,j){var k=!1,l={SEARCH:"#modal_help_search",SEARCH_BUTTON:"#modal_help_search_btn",SUGGESTIONS:"#modal_help_search_suggestions",SUGGESTION_ITEM:".modal-help-suggestion-item"},m={MODAL_HELP_CONTENT:"theme_urcourses_default/modal_help_content",MODAL_HELP_TOPICS:"theme_urcourses_default/modal_help_topics"},n=function(a){b.call(this,a);this.searchBox=this.root.find(l.SEARCH);this.searchButton=this.root.find(l.SEARCH_BUTTON);this.suggestionBox=this.root.find(l.SUGGESTIONS);this.topicList=null;this.suggestionIndex=0};n.prototype=Object.create(b.prototype);n.prototype.constructor=n;n.TYPE="theme_urcourses_default-help";n.prototype.registerEventListeners=function(){var c=this;b.prototype.registerEventListeners.call(this);this.getRoot().on(d.shown,function(){j.getRemtlHelp().then(function(a){var b=i.render(m.MODAL_HELP_CONTENT,{html:a.html});return c.setBody(b)}).catch(h.exception);if(null===c.topicList){j.getTopicList().then(function(a){c.topicList=a;return i.render(m.MODAL_HELP_TOPICS,{topics:a})}).then(function(a,b){return i.replaceNodeContents(l.SUGGESTIONS,a,b)}).catch(h.exception)}});this.getRoot().on(d.hidden,function(){c.setBody("");c.searchBox.val("");c.suggestionBox.addClass("d-none")});this.getModal().on("focus",l.SEARCH,function(){c.suggestionBox.removeClass("d-none")});this.getModal().on("blur",l.SEARCH,function(){c.suggestionBox.addClass("d-none")});this.getModal().on("input",l.SEARCH,function(){var b=c.searchBox.val(),d=RegExp(b.split("").join(".*"),"i"),e=a(l.SUGGESTION_ITEM),f=[];e.addClass("d-none");e.removeClass("selected");if(!b.length){e.eq(0).addClass("selected");e.removeClass("d-none");return}var g=!0,h=!1,i=void 0;try{for(var j=c.topicList[Symbol.iterator](),k;!(g=(k=j.next()).done);g=!0){var m=k.value,n=d.exec(m.title);if(n){f.push({text:m.title,url:m.url,length:n[0].length,start:n.index})}}}catch(a){h=!0;i=a}finally{try{if(!g&&null!=j.return){j.return()}}finally{if(h){throw i}}}f.sort(function(c,a){if(c.length<a.length){return-1}if(c.length>a.length){return 1}if(c.start<a.start){return-1}if(c.start>a.start){return 1}});for(var o=0,p=f;o<p.length;o++){var q=p[o],r=e.filter("[data-value=\"".concat(q.text,"\"]"));r.removeClass("d-none")}e.filter(":not(.d-none)").eq(0).addClass("selected")});this.getModal().on("keydown",l.SEARCH,function(b){var d=a(l.SUGGESTION_ITEM).filter(":not(.d-none)");if(b.keyCode===f.arrowDown||b.keyCode===f.arrowRight){c.suggestionIndex++;if(c.suggestionIndex>=d.length){c.suggestionIndex=0}d.removeClass("selected");d.eq(c.suggestionIndex).addClass("selected")}else if(b.keyCode===f.arrowUp||b.keyCode===f.arrowLeft){c.suggestionIndex--;if(0>c.suggestionIndex){c.suggestionIndex=d.length-1}d.removeClass("selected");d.eq(c.suggestionIndex).addClass("selected")}})};if(!k){c.register(n.TYPE,n,"theme_urcourses_default/modal_help");k=!0}return n});
//# sourceMappingURL=modal_help.min.js.map
