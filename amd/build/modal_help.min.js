define ("theme_urcourses_default/modal_help",["jquery","core/modal","core/modal_registry","core/modal_events","core/key_codes","core/custom_interaction_events","core/notification","core/templates","theme_urcourses_default/modal_help_ajax"],function(a,b,c,d,f,g,h,i,j){var k=!1,l={SEARCH:"#modal_help_search",SEARCH_BUTTON:"#modal_help_search_btn",SUGGESTIONS:"#modal_help_search_suggestions",SUGGESTION_ITEM:".modal-help-suggestion-item",LOADING_OVERLAY:"[data-region=\"overlay-icon-container\"]"},m={MODAL_HELP_CONTENT:"theme_urcourses_default/modal_help_content"},n={SUGGESTION_ACTIVE:"suggestion-active"},o=function(a){b.call(this,a);this.searchBox=this.root.find(l.SEARCH);this.searchButton=this.root.find(l.SEARCH_BUTTON);this.suggestionBox=this.root.find(l.SUGGESTIONS);this.suggestionItemIndex=-1;this.topicsList=null};o.prototype=Object.create(b.prototype);o.prototype.constructor=o;o.TYPE="theme_urcourses_default-help";o.prototype.getNextSuggestion=function(){this.getModal().find(l.SUGGESTION_ITEM).removeClass(n.SUGGESTION_ACTIVE);this.suggestionItemIndex++;if(this.suggestionItemIndex>this.getModal().find(l.SUGGESTION_ITEM).length-1){this.suggestionItemIndex=0}this.getModal().find(l.SUGGESTION_ITEM).eq(this.suggestionItemIndex).addClass(n.SUGGESTION_ACTIVE)};o.prototype.getPrevSuggestion=function(){this.getModal().find(l.SUGGESTION_ITEM).removeClass(n.SUGGESTION_ACTIVE);this.suggestionItemIndex--;if(0>this.suggestionItemIndex){this.suggestionItemIndex=this.getModal().find(l.SUGGESTION_ITEM).length-1}this.getModal().find(l.SUGGESTION_ITEM).eq(this.suggestionItemIndex).addClass(n.SUGGESTION_ACTIVE)};o.prototype.registerEventListeners=function(){var c=this;b.prototype.registerEventListeners.call(this);this.getRoot().on(d.shown,function(){j.getRemtlHelp().then(function(a){var b=i.render(m.MODAL_HELP_CONTENT,{html:a.html});c.setBody(b)}).catch(h.exception);if(null===c.topicsList){j.getTopicList().then(function(a){c.topicsList=a})}});this.getRoot().on(d.hidden,function(){c.setBody("");c.searchBox.val("");c.suggestionBox.html("")});this.getModal().on("input",l.SEARCH,function(){if(null===c.topicsList){return}var a=c.searchBox.val(),b=RegExp(a.split("").join(".*"),"i"),d=[];c.suggestionBox.html("");if(!a.length){return}var e=!0,f=!1,g=void 0;try{for(var h=c.topicsList[Symbol.iterator](),i;!(e=(i=h.next()).done);e=!0){var j=i.value,k=b.exec(j.title);if(k){d.push({text:j.title,length:k[0].length,start:k.index})}}}catch(a){f=!0;g=a}finally{try{if(!e&&null!=h.return){h.return()}}finally{if(f){throw g}}}d.sort(function(c,a){if(c.length<a.length){return-1}if(c.length>a.length){return 1}if(c.start<a.start){return-1}if(c.start>a.start){return 1}});for(var l=0,m=d;l<m.length;l++){var n=m[l],o="<span class=\"modal-help-suggestion-item\" data-value=\"".concat(n.text,"\">").concat(n.text,"</span>");c.suggestionBox.append(o)}});this.getModal().on("keydown",l.SEARCH,function(a){if(a.keyCode===f.arrowUp||a.keyCode===f.arrowLeft){a.preventDefault();c.getPrevSuggestion()}else if(a.keyCode===f.arrowDown||a.keyCode===f.arrowRight){a.preventDefault();c.getNextSuggestion()}});this.getModal().on("keydown",l.SUGGESTIONS,function(a){if(a.keyCode===f.arrowUp||a.keyCode===f.arrowLeft){a.preventDefault();c.getPrevSuggestion()}else if(a.keyCode===f.arrowDown||a.keyCode===f.arrowRight){a.preventDefault();c.getNextSuggestion()}else if(a.keyCode===f.escape){a.preventDefault();c.getModal().find(l.SUGGESTIONS).html("")}});g.define(this.getModal().find(l.SUGGESTION_ITEM,[g.events.activate]));this.getModal().on("".concat(g.events.activate," ").concat(g.events.keyboardActivate),l.SUGGESTION_ITEM,function(){a(l.SEARCH).val(a(this).attr("data-value"));a(l.SUGGESTIONS).html("")});this.getModal().on("mouseover",l.SUGGESTIONS,function(){c.suggestionItemIndex=-1;c.getModal().find(l.SUGGESTION_ITEM).removeClass(n.SUGGESTION_ACTIVE)})};if(!k){c.register(o.TYPE,o,"theme_urcourses_default/modal_help");k=!0}return o});
//# sourceMappingURL=modal_help.min.js.map
