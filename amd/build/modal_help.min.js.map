{"version":3,"sources":["../src/modal_help.js"],"names":["SELECTORS","SEARCH","SEARCH_BUTTON","SEARCH_CLEAR","SUGGESTIONS","SUGGESTION_ITEM","SEARCH_RESULT","BREADCRUMBS","BREADCRUMB","BREADCRUMB_SEARCH","BREADCRUMB_HOME","BREADCRUMB_PAGE","GUIDE_PAGE_LINK","OVERLAY_LOADING","HOME","BACK","MAIN","TEMPLATES","MODAL_HELP_GUIDE_PAGE","MODAL_HELP_SEARCH_RESULTS","ModalHelp","root","contextId","topicList","topicTitles","searchBox","modal","find","searchButton","searchClear","suggestionBox","content","suggestionItemIndex","currentPath","history","landingPageUrl","localUrl","Promise","all","getTopicList","ModalHelpAjax","getLandingPageUrl","map","topic","title","FuzzySearch","setDictionary","initEvents","Notification","exception","on","val","showSearchClear","hideSearchClear","updateSuggestions","clearSearch","getRoot","e","target","hideSuggestionBox","keyCode","KeyCodes","arrowUp","arrowLeft","preventDefault","getSuggestionItems","length","eq","focus","arrowDown","arrowRight","ModalEvents","shown","renderGuidePage","url","hidden","resetModal","CustomEvents","events","activate","suggestion","topicTitle","attr","topicTitleLower","toLowerCase","replace","query","searchGuides","enter","getModal","href","currentTarget","startsWith","window","open","split","path","hrefPath","actualPath","node","pop","push","join","breadcrumb","getTopicListUrl","instructor","getJsonData","topicListJson","topics","jsondata","page_data","all_pages","topicsSorted","sort","a","b","prefix","filter","suggestions","search","suggestionList","getSuggestions","html","append","showSuggestionBox","setLoading","getSearchUrl","searchUrl","searchResults","breadcrumbs","active","name","renderReplace","results","getBody","scrollTop","page","frontmatter","unshift","breadcrumbUrl","breadcrumbPage","substring","lastIndexOf","anchor","scrollIntoView","fetch","response","json","loading","renderAppend","visible","remove","template","data","area","Templates","render","then","js","replaceNodeContents","appendNodeContents","setBody","removeClass","addClass","Modal","registered","ModalRegistry","register","getType"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Campus - ModalHelp class\n *\n * @package    theme_urcourses_default\n * @author     John Lane\n *\n */\n\nimport $ from 'jquery';\nimport Notification from 'core/notification';\nimport Templates from 'core/templates';\nimport CustomEvents from 'core/custom_interaction_events';\nimport KeyCodes from 'core/key_codes';\nimport Modal from 'core/modal';\nimport ModalEvents from 'core/modal_events';\nimport ModalRegistry from 'core/modal_registry';\nimport ModalHelpAjax from 'theme_urcourses_default/modal_help_ajax';\nimport FuzzySearch from 'theme_urcourses_default/fuzzysearch';\n\nconst SELECTORS = {\n    SEARCH: '#modal_help_search',\n    SEARCH_BUTTON: '#modal_help_search_btn',\n    SEARCH_CLEAR: '#modal_help_search_clear',\n    SUGGESTIONS: '#modal_help_search_suggestions',\n    SUGGESTION_ITEM: '.modal-help-suggestion-item',\n    SEARCH_RESULT: '.modal-help-search-result',\n    BREADCRUMBS: '#breadcrumbs',\n    BREADCRUMB: '.breadcrumb-item a',\n    BREADCRUMB_SEARCH: '#breadcrumb_search',\n    BREADCRUMB_HOME: '#breadcrumb_home',\n    BREADCRUMB_PAGE: '#breadcrumb_page',\n    GUIDE_PAGE_LINK: '[data-region=\"guide-page-content\"] a',\n    OVERLAY_LOADING: '.overlay-icon-container',\n    HOME: '[data-action=\"go-home\"]',\n    BACK: '[data-action=\"go-back\"]',\n    MAIN: '[data-region=\"modal-help-main\"]'\n};\n\nconst TEMPLATES = {\n    MODAL_HELP_GUIDE_PAGE: 'theme_urcourses_default/modal_help_guide_page',\n    MODAL_HELP_SEARCH_RESULTS: 'theme_urcourses_default/modal_help_search_results',\n    OVERLAY_LOADING: 'core/overlay_loading'\n};\n\n/**\n * UR Courses help modal.\n * \n * @class ModalHelp\n * @property {Number} contextId Context ID number.\n * @property {Array} topicList Array of help topics.\n * @property {Array} topicTitles Titles of help topics.\n * @property {Object} searchBox Search input.\n * @property {Object} searchButton Search submit.\n * @property {Object} searchClear Clears search value.\n * @property {Object} suggestionBox Predictive search suggestion list.\n * @property {Object} suggestionItemIndex suggestionBox item index.\n */\nexport default class ModalHelp extends Modal {\n\n    constructor(root) {\n        super(root);\n        this.contextId = null;\n        this.topicList = null;\n        this.topicTitles = null;\n        this.searchBox = this.modal.find(SELECTORS.SEARCH);\n        this.searchButton = this.modal.find(SELECTORS.SEARCH_BUTTON);\n        this.searchClear = this.modal.find(SELECTORS.SEARCH_CLEAR);\n        this.suggestionBox = this.modal.find(SELECTORS.SUGGESTIONS);\n        this.content = this.modal.find(SELECTORS.MAIN);\n        this.suggestionItemIndex = 0;\n        this.currentPath = '';\n        this.history = [];\n        this.landingPageUrl = '';\n    }\n\n    /**\n     * Setup for topic list, home page, and events.\n     *\n     * @param {Number} contextId Context ID number.\n     * @param {String} localUrl The local path relative to the site root.\n     */\n    async init(contextId, localUrl) {\n        try {\n            this.contextId = contextId;\n            [this.topicList, this.landingPageUrl] = await Promise.all([\n                this.getTopicList(),\n                ModalHelpAjax.getLandingPageUrl(this.contextId, localUrl)\n            ]);\n            this.topicTitles = this.topicList.map(topic => topic.title);\n            FuzzySearch.setDictionary(this.topicTitles);\n            this.initEvents();\n        } catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Registers event listeners.\n     */\n    initEvents() {\n\n        // PREDICTIVE SEARCH EVENTS //\n\n        /** Update suggestion list based on input. */\n        this.searchBox.on('input', () => {\n            if (this.searchBox.val()) {\n                this.showSearchClear();\n            } else {\n                this.hideSearchClear();\n            }\n            this.updateSuggestions();\n        });\n\n        /** Show suggestion list when search box is in focus. */\n        this.searchBox.on('focus', () => {\n            this.updateSuggestions();\n        });\n\n        /** Clear search value if search clear button is clicked. */\n        this.searchClear.on('click', () => {\n            this.clearSearch();\n        });\n\n        /** Hide suggestions if user clicks away from search box. */\n        this.getRoot().on('click', (e) => {\n            if (e.target !== this.searchBox[0] && e.target !== this.suggestionBox[0]) {\n                this.hideSuggestionBox();\n            }\n        });\n\n        /** If user presses up or down while focused on search, focus on suggestions. */\n        this.searchBox.on('keydown', (e) => {\n            if (e.keyCode === KeyCodes.arrowUp || e.keyCode === KeyCodes.arrowLeft) {\n                e.preventDefault();\n                this.suggestionItemIndex = this.getSuggestionItems().length - 0;\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n            else if (e.keyCode === KeyCodes.arrowDown || e.keyCode === KeyCodes.arrowRight) {\n                e.preventDefault();\n                this.suggestionItemIndex = -1;\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n        });\n\n        /** If user is focused on suggestions, cycle through list. */\n        this.suggestionBox.on('keydown', SELECTORS.SUGGESTION_ITEM, (e) => {\n            if (e.keyCode === KeyCodes.arrowUp || e.keyCode === KeyCodes.arrowLeft) {\n                e.preventDefault();\n                this.suggestionItemIndex--;\n                if (this.suggestionItemIndex < -1) {\n                    this.suggestionItemIndex = this.getSuggestionItems().length - 0;\n                }\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n            else if (e.keyCode === KeyCodes.arrowDown || e.keyCode === KeyCodes.arrowRight) {\n                e.preventDefault();\n                this.suggestionItemIndex++;\n                if (this.suggestionItemIndex >= this.getSuggestionItems().length) {\n                    this.suggestionItemIndex = -1;\n                }\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n        });\n\n        // GUIDE PAGE EVENTS //\n\n        /** Show home page when modal is open. */\n        this.getRoot().on(ModalEvents.shown, () => {\n            this.renderGuidePage(this.landingPageUrl.url, this.landingPageUrl.target);\n        });\n\n        /** Reset modal to default when closed. */\n        this.getRoot().on(ModalEvents.hidden, () => {\n            this.resetModal();\n        });\n\n        /** Open suggestion page if user clicks or presses enter. */\n        this.suggestionBox.on(CustomEvents.events.activate, SELECTORS.SUGGESTION_ITEM, (e) => {\n            const suggestion = $(e.target);\n            const topicTitle = suggestion.attr('data-value');\n            const topicTitleLower = topicTitle.toLowerCase().replace(/&/g, '&amp;');\n            const topic = this.topicList.find(topic => topic.title.toLowerCase() === topicTitleLower);\n            const url = `${topic.url}.json`;\n            this.searchBox.val(topicTitle);\n            this.showSearchClear();\n            this.renderGuidePage(url);\n        });\n\n        /** Search on click. */\n        this.searchButton.on('click', () => {\n            const query = this.searchBox.val();\n            this.searchGuides(query);\n            this.hideSuggestionBox();\n        });\n\n        /** Search on enter. */\n        this.searchBox.on('keydown', (e) => {\n            if (e.keyCode === KeyCodes.enter) {\n                const query = this.searchBox.val();\n                this.searchGuides(query);\n                this.getModal().focus();\n                this.hideSuggestionBox();\n            }\n        });\n\n        /** Open search result. */\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.SEARCH_RESULT, (e) => {\n            const url = $(e.target).attr('data-url');\n            this.renderGuidePage(`${url}.json`);\n        });\n\n        /** If the user clicks a link inside the guide page, open the page. */\n        this.getRoot().on('click', SELECTORS.GUIDE_PAGE_LINK, (e) => {\n            const href = $(e.currentTarget).attr('href');\n            if (href.startsWith('#') ) return;\n            e.preventDefault();\n            if (href.startsWith('http') || href.startsWith('https') || href.startsWith('mailto')) {\n                window.open(href, '_blank');\n            } else {\n                const [path, target] = href.split('#');\n                const hrefPath = path.split('/');\n                const actualPath = this.currentPath.split('/');\n                for (const node of hrefPath) {\n                    if (node === '..') actualPath.pop();\n                    else if (node !== '.') actualPath.push(node);\n                }\n                const url = actualPath.join('/');\n                this.renderGuidePage(`${url}.json`, target);\n            }\n        });\n\n        this.getModal().on('click', SELECTORS.BREADCRUMB, (e) => {\n            e.preventDefault();\n            const breadcrumb = $(e.currentTarget);\n            const url = breadcrumb.attr('href');\n            const target = breadcrumb.attr('data-target');\n            this.renderGuidePage(url, target);\n        });\n\n        this.getModal().on('click', SELECTORS.BACK, (e) => {\n            e.preventDefault();\n            if (this.history.length > 1) {\n                this.history.pop();\n                const [url, target] = this.history.pop();\n                this.renderGuidePage(url, target);\n            }\n        });\n\n        this.getModal().on('click', SELECTORS.HOME, (e) => {\n            e.preventDefault();\n            const {url, target} = this.landingPageUrl;\n            this.renderGuidePage(url, target);\n        });\n\n    }\n       \n    /**\n     * Get list of help topics.\n     * @return {Array} Array of topics.\n     */\n    async getTopicList() {\n        const {instructor, url} = await ModalHelpAjax.getTopicListUrl(this.contextId);\n        const topicListJson = await this.getJsonData(url);\n        const topics = topicListJson.jsondata.page_data[0].all_pages;\n        const topicsSorted = topics.sort((a, b) => a.title > b.title);\n        const prefix = instructor ? 'Instructor' : 'Students';\n        return topicsSorted.filter(topic => topic.prefix === prefix);\n    }\n\n    /**\n     * Updates the suggestion list based on whatever is in the search box.\n     */\n    updateSuggestions() {\n        const query = this.searchBox.val();\n        let suggestions = FuzzySearch.search(query);\n        if (!suggestions.length) {\n            suggestions = this.topicTitles;\n        }\n        const suggestionList = this.getSuggestions(suggestions);\n        this.suggestionBox.html('');\n        this.suggestionBox.append(suggestionList);\n        this.showSuggestionBox();\n    }\n\n    /**\n     * Returns html markup based on list of suggested words.\n     * @param {Array} suggestions - List of suggested words.\n     * @returns {Array} An array of html tags.\n     */\n    getSuggestions(suggestions) {\n        return suggestions.map(suggestion => `<a href=\"#\" class=\"modal-help-suggestion-item\"\n                                              data-value=\"${suggestion}\">${suggestion}</a>`);\n    }\n\n    /**\n     * Searches the guides and displays results.\n     * @param {String} query\n     */\n    async searchGuides(query) {\n        if (!query) return;\n        try {\n            await this.setLoading(true);\n            const searchUrl = await ModalHelpAjax.getSearchUrl(this.contextId, query);\n            const searchResults = await this.getJsonData(searchUrl);\n            const breadcrumbs = [{\n                active: true,\n                name: `Search Results: ${query}`,\n                url: '',\n                target: '',\n            }];\n            await this.renderReplace(TEMPLATES.MODAL_HELP_SEARCH_RESULTS, {results: searchResults.jsondata, query: query, breadcrumbs: breadcrumbs}, this.content);\n            this.getBody()[0].scrollTop = 0;\n            \n            this.history.push([searchUrl]);\n        } catch (error) {\n            Notification.exception(error);\n        } finally {\n            this.setLoading(false);\n        }\n    }\n\n    /**\n     * Load content from the url into the modal. Scroll to target if one is provided.\n     * @param {String} url Url to fetch from.\n     * @param {String} target Anchor to scroll to when url is loaded.\n     */\n    async renderGuidePage(url, target = '') {\n        try {\n            await this.setLoading(true);\n            const page = await this.getJsonData(url);\n            const breadcrumbs = [];\n            const {content, frontmatter, jsondata} = page;\n            const {title} = frontmatter ? frontmatter : jsondata.page_data[0];\n            const path = url.split('/');\n\n            breadcrumbs.unshift({\n                active: true,\n                name: title,\n                target: target,\n                url: url,\n            });\n            path.pop();\n            while (path[path.length - 1] !== 'guides') {\n                const breadcrumbUrl = `${path.join('/')}.json`;\n                const breadcrumbPage = await this.getJsonData(breadcrumbUrl);\n                const {frontmatter, jsondata} = breadcrumbPage;\n                const {title} = frontmatter ? frontmatter : jsondata.page_data[0];\n                breadcrumbs.unshift({\n                    active: false,\n                    name: title,\n                    url: breadcrumbUrl\n                });\n                path.pop();\n            }\n\n            const html = content ? content : jsondata.page_data[0].content;\n            await this.renderReplace(TEMPLATES.MODAL_HELP_GUIDE_PAGE, {html: html, breadcrumbs: breadcrumbs}, this.content);\n            this.currentPath = url.substring(0, url.lastIndexOf('/'));\n            const anchor = $(target);\n            if (anchor.length) anchor[0].scrollIntoView();\n            else this.getBody()[0].scrollTop = 0;\n        \n            this.history.push([url, target]);\n        } catch (error) {\n            Notification.exception(error);\n        } finally {\n            this.setLoading(false);\n        }\n    }\n\n    /**\n     * Fetches from url and returns json.\n     * @param {String} url Url to fetch from.\n     */\n    async getJsonData(url) {\n        const response = await fetch(url);\n        return response.json();\n    }\n\n    /**\n     * Appends a loading spinner to modal if loading is true, removes spinner if false.\n     * @param {Boolean} loading True for loading, contentfalse for not-loading.\n     */\n    setLoading(loading) {\n        if (loading) {\n            return this.renderAppend(TEMPLATES.OVERLAY_LOADING, {visible: true}, this.content);\n        } else {\n            this.getBody().find(SELECTORS.OVERLAY_LOADING).remove();\n        }\n    }\n\n    /**\n     * Render template using data and replace area.\n     * @param {String} template Template to render.\n     * @param {Object} data Template data.\n     * @param {Object|String} area Selector or jquery object.\n     */\n    renderReplace(template, data, area) {\n        return Templates.render(template, data)\n            .then((html, js) => Templates.replaceNodeContents(area, html, js));\n    }\n\n    /**\n     * Render template using data and append to area.\n     * @param {String} template Template to render.\n     * @param {Object} data Template data.\n     * @param {Object|String} area Selector or jquery object.\n     */\n    renderAppend(template, data, area) {\n        return Templates.render(template, data)\n            .then((html, js) => Templates.appendNodeContents(area, html, js));\n    }\n\n    /**\n     * Resets modal content and search.\n     */\n    resetModal() {\n        this.setBody('');\n        this.searchBox.val('');\n        this.suggestionBox.html('');\n    }\n\n    /**\n     * Clears whatever is in the search box.\n     */\n    clearSearch() {\n        this.searchBox.val('');\n        this.hideSearchClear();\n    }\n\n    /**\n     * Removes d-none class from suggestion box and scrolls to the top of the list.\n     */\n    showSuggestionBox() {\n        this.suggestionBox.removeClass('d-none');\n        this.suggestionBox[0].scrollTop = 0;\n    }\n\n    /**\n     * Adds d-none class to suggestion box.\n     */\n    hideSuggestionBox() {\n        this.suggestionBox.addClass('d-none');\n    }\n\n    /**\n     * Removes d-none class from clear search button.\n     */\n    showSearchClear() {\n        this.searchClear.removeClass('d-none');\n    }\n\n    /**\n     * Adds d-none class to clear search button.\n     */\n    hideSearchClear() {\n        this.searchClear.addClass('d-none');\n    }\n\n    /**\n     * Returns an array of suggestions in the suggestion box.\n     * @returns {JQuery}\n     */\n    getSuggestionItems() {\n        return this.suggestionBox.find(SELECTORS.SUGGESTION_ITEM);\n    }\n\n    /**\n     * Returns modal type. Used when creating the modal using ModalFactory.\n     * @returns {String}\n     */\n    static getType() {\n        return 'theme_urcourses_default-help';\n    }\n}\n\n// Setup code for adding ModalHelp to the modal factory.\nlet registered = false;\nif (!registered) {\n    ModalRegistry.register(ModalHelp.getType(), ModalHelp, 'theme_urcourses_default/modal_help');\n    registered = true;\n}\n"],"file":"modal_help.min.js"}