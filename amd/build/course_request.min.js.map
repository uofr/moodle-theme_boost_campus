{"version":3,"sources":["../src/course_request.js"],"names":["define","$","ajax","notification","str","ModalFactory","ModalEvents","courseActionsLib","_root","_course","_categories","_templatelist","SELECTORS","HEADER","HEADER_TOP","BTN_COURSETOOLS","BTN_DUPLICATE","BTN_NEW","BTN_STUDENT_ACCOUNT","BTN_STUDENT_ENROL","BTN_DESCRIPTION","_setGlobals","root","course","templatelist","categories","id","coursename","shortname","startdate","enddate","_registerEventListeners","on","_courseAction","_editCourseDescription","_createStudentAction","_enrollStudentAction","_element","coursereqAction","category","value","data","username","getStudentAccountInfo","create","type","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","getRoot","cancel","find","parent","click","CANCEL","show","save","e","preventDefault","append","checked","is","_createStudentAccount","args","courseid","ajaxCall","methodname","fail","exception","promise","call","done","userid","info","email","datecreated","text","hidden","remove","bind","_resetStudentAccount","response","_studentAccountResponse","unenroll","reset","created","enrolled","location","reload","modaltitle","modalaction","_unenrollStudentAccount","origin","window","href","substring","lastIndexOf","target","_checkCourseEdit","indexOf","hash","navHeight","outerHeight","animate","scrollTop","offset","top","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Responsible for registering all events for Course Tools including:\n * Course Creation-> calls Course Action Library to handle modals and ajax request\n * Course Duplication-> calls Course Action Library to handle modals and ajax request\n * Create Student Account-> performs ajax request to create a student account for instructor\n * Course Description Edit-> Reroutes to Course Edit page, and add marker to go right to Course Summary Section\n *\n * @package    theme_urcourses_default\n * @author     Brooke Clary\n * \n */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'core/str',\n    'core/modal_factory', 'core/modal_events','theme_urcourses_default/course_actions'], function($, ajax, notification, str, ModalFactory, ModalEvents,courseActionsLib) {\n\n    /** Container jquery object. */\n    var _root;\n    /** Course ID */\n    var _course;\n    var _categories;\n    var _templatelist;\n\n    /** Jquery selector strings. */\n    var SELECTORS = {\n        HEADER: '#page-header .header-body',\n        HEADER_TOP: \"#page-header .page-head\",\n        BTN_COURSETOOLS: '#btn_coursetools',\n        BTN_DUPLICATE: '#btn_duplicate',\n        BTN_NEW: '#btn_new',\n        BTN_STUDENT_ACCOUNT: '#btn_student_account',\n        BTN_STUDENT_ENROL: '#btn_student_enrol',\n        BTN_DESCRIPTION: '#btn_editdescription',\n    };\n\n    /**\n     * Initializes global variables.\n     * @param {string} root - Jquery selector for container.\n     * @param {int} headerstyle - selected header style.\n     * @param {int} courseid - ID of current course.\n     * @return void\n     */\n    var _setGlobals = function(root, course,templatelist, categories) {\n       _root = $(root);\n       _course = course;\n       _templatelist = templatelist;\n       _categories = categories;\n\n       //course constructor, incase any create or duplicate course\n       courseActionsLib = new courseActionsLib(_course.id,_course.coursename, _course.shortname, _course.startdate, _course.enddate, _templatelist, _categories);\n    };\n\n    /**\n     * Sets up event listeners.\n     * @return void\n     */\n    var _registerEventListeners = function() {\n\n        _root.on('click', SELECTORS.BTN_COURSETOOLS, _courseAction);\n        _root.on('click', SELECTORS.BTN_DUPLICATE, _courseAction);\n        _root.on('click', SELECTORS.BTN_NEW, _courseAction);\n        _root.on('click', SELECTORS.BTN_DESCRIPTION, _editCourseDescription);\n        _root.on('click', SELECTORS.BTN_STUDENT_ACCOUNT, _createStudentAction);\n        _root.on('click', SELECTORS.BTN_STUDENT_ENROL, _enrollStudentAction);\n    };\n\n    /**\n     * If course has been used in previous term, options to\n     * duplicate or create are given. If either duplicate or create are \n     * clicked they are passed to this function, which calls on the \n     * Course Action Library to provide the correct modals, and perform \n     * any ajax requests\n     */\n    var _courseAction = function() {\n\n        var button = \"btn_new\";\n        var _element = $(this);\n\n        courseActionsLib.coursereqAction(_element,button, _course.category, _course.startdate, _course.enddate);\n    }\n\n     /**\n     * Modal after button click to create student account\n     */\n    var _createStudentAction =  function(e) {\n\n\n        //look if created or not\n        var value =$(SELECTORS.BTN_STUDENT_ACCOUNT).data(\"value\");\n        var username =$(SELECTORS.BTN_STUDENT_ACCOUNT).data(\"username\");\n\n        if(value){\n            //view student account info\n             getStudentAccountInfo(username);\n        }else{\n        \n            var modaltitle = 'Create a test student for UR Courses';\n            var modalaction = '<b>The following test user account will be created: </b><br><br>'\n                            + '<b>Email address </b>'\n                            +'<a class=\"btn btn-link p-0\" role=\"button\" data-toggle=\"modal\" data-placement=\"right\" data-target=\"moodle-email-modal-dialogue\" data-html=\"true\">'\n                                +'<i class=\"icon fa fa-question-circle text-info fa-fw \" title=\"Help with test student account email\" aria-label=\"Help with test student account email\"></i>'\n                            +'</a><br>'+username+'+urstudent@uregina.ca'\n                            +'<br><b>Username </b><br>'+username+'-urstudent'\n                            +'<hr/>'\n         \n                            +'<br> You can enrol this account as a student for the ability to test and experience the course as a student.'\n                            +'<br><br>'\n                            +'<b>Would you like to create the test student account?</b>'\n                            +'<br><label class=\"form-check  fitem  \">'\n                            +'<input type=\"checkbox\" name=\"id_enroll_test\" class=\"form-check-input \" id=\"id_enroll_test\" value=\"1\" size=\"\" checked>'\n                            +'Enrol test student into this course'\n                            +'</label>'\n                        \n                           // +'<li class=\"divider\"></li>'\n                            \n                             ;\n            \n            //adding in confirmation modal in case buttons accidentally clicked\n            ModalFactory.create({\n                type: ModalFactory.types.SAVE_CANCEL,\n                title: modaltitle,\n                body: \"<p>\"+ modalaction +\"</p>\"\n            }).then(function(modal) {\n                \n                modal.setSaveButtonText('Create');\n                var root = modal.getRoot();\n                root.on(ModalEvents.cancel, function(){\n                    return;\n                });\n\n                $(root).find('.fa-question-circle').parent().click(function() {\n                    ModalFactory.create({\n                        type: ModalFactory.types.CANCEL,\n                        title: \"Help with test student account email\",\n                        body:'<p>Email sent to this address will appear in your username@uregina.ca inbox</p>',\n                    }).then(function(modal) {\n                        modal.show();\n                    });\n                });\n\n                root.on(ModalEvents.save, function(e){\n                    e.preventDefault();  \n                    $(root).find('button[data-action=\"save\"]').append(' <span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span><span class=\"sr-only\">Loading...</span>');\n                    var checked = $(root).find(\"#id_enroll_test\").is(\":checked\");\n                    _createStudentAccount(username, checked);\n                });\n\n                modal.show();\n            });\n        }\n    };\n\n    /**\n     * After modal info has been entered call ajax request\n     */\n    var getStudentAccountInfo =  function(username) {\n          // return if required values aren't set\n          if (!_course.id) {\n            return;\n        }\n\n        // set args\n        var args = {\n            courseid: _course.id,\n            username: username\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_test_account_info',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise =  ajax.call([ajaxCall]);\n        promise[0].done(function(data) {\n\n            var modaltitle = 'User details for test student account';\n\n            if(data.userid != 0){\n               info = '<b>Email address </b>'\n                    +'<a class=\"btn btn-link p-0\" role=\"button\" data-toggle=\"modal\" data-placement=\"right\" data-target=\"moodle-email-modal-dialogue\" data-html=\"true\">'\n                        +'<i class=\"icon fa fa-question-circle text-info fa-fw \" title=\"Help with test student account email\" aria-label=\"Help with test student account email\"></i>'\n                    +'</a><br>'+data.email\n                    +'<br><b>Username </b><br>'+data.username\n                    +'<br><b>Account Creation Date </b><br>'+data.datecreated+'<br/>'\n                    +'<br><div class=\"alert alert-warning d-flex justify-content-between bd-highlight \" role=\"alert\">'\n                        +'<div class=\"\">Reset test account password </div>'  \n                        +'<button id=\"test_account_reset\" type=\"button\" class=\"btn btn-primary\" >Reset Password</button>' \n                    +'</div>'\n               \n            }else{\n               info= '<div class=\"alert alert-warning\" role=\"alert\">'\n                    +' Test student account could not be found!</div>';\n            }\n            \n            //adding in confirmation modal in case buttons accidentally clicked\n            ModalFactory.create({\n                type: ModalFactory.types.CANCEL,\n                title: modaltitle,\n                body:info,\n\n            }).then(function(modal) {\n            \n                var root = modal.getRoot();\n            \n                $(root).find('button[data-action=\"cancel\"]').text(\"Close\");\n\n                $(root).find('.fa-question-circle').parent().click(function() {\n                    ModalFactory.create({\n                        type: ModalFactory.types.CANCEL,\n                        title: \"Help with test student account email\",\n                        body:'<p>Email sent to this address will appear in your username@uregina.ca inbox</p>',\n                    }).then(function(modal) {\n                        modal.show();\n                    });\n                });\n\n                 //remove modal on hide\n                 root.on(ModalEvents.hidden, function(){\n                    //remove inputs otherwise duplicates are made causing id problems\n                    $( \"#test_account_reset\" ).remove();\n                });\n\n                modal.show();\n            }).done(function(modal) {\n                $(\"#test_account_reset\").bind('click', function() { _resetStudentAccount($(this), username); } );\n            });\n        }).fail(function(ex) {\n            notification.exception;\n        });\t\n\n    }\n\n     /**\n     * After modal info has been entered call ajax request\n     */\n    var _createStudentAccount = function(username, checked) {\n\n        // return if required values aren't set\n        if (!_course.id) {\n            return;\n        }\n\n        // set args\n        var args = {\n            courseid: _course.id,\n            username: username,\n            checked: checked\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_create_test_account',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            _studentAccountResponse(response);\n        }).fail(function(ex) {\n            notification.exception;\n        });\t\n    };\n    /**\n     * Handles ajax return and response to return data\n     * @param {Object} response \n     */\n    var _studentAccountResponse = function(data) {\n    \n        if(typeof data.unenroll != \"undefined\"){\n\n            title = \"Success: \";\n            info='<div class=\"alert alert-success\" role=\"alert\">'\n                    +data.username+\" was removed from course. </div>\";\n\n            if(!data.unenroll){\n                title = \"ERROR:\"\n                info='<div class=\"alert alert-warning\" role=\"alert\">';\n                info += data.username+\" could not be removed from course. </div>\";\n            }\n        }else if(typeof data.reset != \"undefined\"){\n            title = \"Success: \";\n            info='<div class=\"alert alert-success\" role=\"alert\">'\n                    +data.username+\" password was reset. You will recieve an email with new credentials. It may take a few minutes to process.</div>\";\n\n            if(!data.reset && data.userid !=0){\n                title = \"ERROR:\"\n                info='<div class=\"alert alert-warning\" role=\"alert\">';\n                info += data.username+\"'s password could not be reset, email failed to send </div>\";\n            }else if(!data.reset && data.userid ==0){\n                title = \"ERROR:\"\n                info='<div class=\"alert alert-warning\" role=\"alert\">';\n                info += data.username+\"'s account could not be found </div>\";\n            }\n        }else{\n\n            //create new modal\n            title = \"Success: \";\n            info='<div class=\"alert alert-success\" role=\"alert\">';\n\n            //if both actions were done\n            if(data.created != false && data.enrolled !=false){\n                info +=data.username+\" was created and enrolled into this course. New account information has been emailed to you. </div>\";\n            }else if(data.created != false && data.enrolled ==false ){\n                info += data.username+\" was created, but was NOT enrolled into this course. New account information has been emailed to you. </div>\";\n            }else if(data.created == false && data.enrolled !=false ){\n                info += data.username+\" has been enrolled into this course.</div>\";\n            }else{\n                title = \"ERROR:\"\n                info='<div class=\"alert alert-warning\" role=\"alert\">';\n                info += data.username+\" already exists and is enrolled into the course. </div>\";\n            }\n        }\n        \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.CANCEL,\n            title: title,\n            body:  info \n        })\n        .then(function(modal) {\n            \n            var root = modal.getRoot();\n            $(root).find('button[data-action=\"cancel\"]').text(\"Close\");\n            root.on(ModalEvents.cancel, function(){\n                if(typeof data.reset == \"undefined\"){\n                    location.reload();\n                }\n                return;\n            });\n           \n            \n            root.find(\".close\").click(function() {\n                if(typeof data.reset == \"undefined\"){\n                    location.reload();\n                }\n                return;\n            });\n\n            modal.show();\n        });\n    };\n\n\n    /**\n     * After modal info has been entered call ajax request\n     */\n    var _enrollStudentAction = function() {\n\n        //look if created or not\n        var value =$(SELECTORS.BTN_STUDENT_ENROL).data(\"value\");\n        var username =$(SELECTORS.BTN_STUDENT_ENROL).data(\"username\");\n        \n        var modaltitle =  (value) ? 'Unenrol test student account in course' :'Enrol test student account in course';\n        var modalaction =  (value) ? 'remove ':  'enrol the test student account ';\n        modalaction = modalaction+username+'+urstudent@uregina.ca from course';\n            \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modaltitle,\n            body: \"<p><b>Do you want to \"+ modalaction +\"?</b><br /></p>\"\n        }).then(function(modal) {\n                \n            (value) ?modal.setSaveButtonText('Remove'):modal.setSaveButtonText('Enrol');\n            var root = modal.getRoot();\n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n\n            root.on(ModalEvents.save, function(e){\n                e.preventDefault();  \n                $(root).find('button[data-action=\"save\"]').append(' <span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span><span class=\"sr-only\">Loading...</span>');\n                (value) ? _unenrollStudentAccount(username) : _createStudentAccount(username,true);\n            });\n\n            modal.show();\n        });\n    }\n\n    /**\n    * After modal info has been entered call ajax request\n    */\n    var _resetStudentAccount = function(e, username) { \n\n        var modaltitle = 'Unenrol test student account';\n        var modalaction = 'do you want to reset the password for student account '+username+'+urstudent@uregina.ca.';\n        \n        //adding in confirmation modal in case buttons accidentally clicked\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: modaltitle,\n            body: \"<p><b>Do you want to \"+ modalaction +\"?</b><br /></p>\"\n        }).then(function(modal) {\n            \n            modal.setSaveButtonText('Reset Password');\n            var root = modal.getRoot();\n          \n            root.on(ModalEvents.cancel, function(){\n                return;\n            });\n\n            root.on(ModalEvents.save, function(e){\n\n                e.preventDefault();  \n                $(root).find('button[data-action=\"save\"]').append('<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span><span class=\"sr-only\">Loading...</span>');\n                \n                // set args\n                var args = {\n                    courseid: _course.id,\n                    username: username\n                };\n\n                // set ajax call\n                var ajaxCall = {\n                    methodname: 'theme_urcourses_default_header_reset_test_account',\n                    args: args,\n                    fail: notification.exception\n                };\n\n                // initiate ajax call\n                var promise = ajax.call([ajaxCall]);\n                promise[0].done(function(response) {\n                    $(root).find('button[data-action=\"cancel\"]').click();\n                    _studentAccountResponse(response);\n                    return;\n                }).fail(function(ex) {\n                    notification.exception;\n                });\n            });\n\n            modal.show();\n        });\n    }\n    /**\n    * After modal info has been entered call ajax request\n    */\n    var _unenrollStudentAccount = function(username) {\n\n        // return if required values aren't set\n        if (!_course.id) {\n            return;\n        }\n\n        // set args\n        var args = {\n            courseid: _course.id,\n            username: username\n        };\n\n        // set ajax call\n        var ajaxCall = {\n            methodname: 'theme_urcourses_default_header_unenroll_test_account',\n            args: args,\n            fail: notification.exception\n        };\n\n        // initiate ajax call\n        var promise = ajax.call([ajaxCall]);\n        promise[0].done(function(response) {\n            _studentAccountResponse(response);\n        }).fail(function(ex) {\n            notification.exception;\n        });\t\n    };\n     /**\n     * Link to course edit page to edit course description\n     */\n    var _editCourseDescription = function() {\n\n        var origin   = window.location.href;    \n        origin =origin.substring(0,origin.lastIndexOf('/'));\n\n        var target = origin + \"/edit.php?id=\"+_course.id+\"#id_descriptionhdr\";\n        window.location.href = target;\n    };\n\n     /**\n     * Check if on course edit page and if hash has been added to url\n     */\n    var _checkCourseEdit = function() {\n\n        var origin   = window.location.href;     \n\n        if (origin.indexOf(\"course/edit.php\") >= 0){\n            if(window.location.hash != \"\"){\n                var navHeight = $('.navbar').outerHeight();\n                $('html, body').animate({\n                    scrollTop: $(window.location.hash).offset().top - navHeight\n                }, 2000);\n            }\n        }\n    };\n\n    /**\n     * Entry point to module. Sets globals and registers event listeners.\n     * @param {String} root Jquery selector for container.\n     * @return void\n     */\n    var init = function(root, course, templatelist, categories) {\n        _setGlobals(root, course, templatelist,categories);\n        _registerEventListeners();\n\n        //little hacky way to use a scroll jump on course edit page without editing course edit\n        _checkCourseEdit();\n    };\n\n    return {\n        init: init\n    };\n\n});"],"file":"course_request.min.js"}