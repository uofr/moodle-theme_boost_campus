define ("theme_urcourses_default/course_request",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g,h,i,j,k,l={HEADER:"#page-header .header-body",HEADER_TOP:"#page-header .page-head",BTN_COURSETOOLS:"#btn_coursetools",BTN_DUPLICATE:"#btn_duplicate",BTN_NEW:"#btn_new",BTN_STUDENT:"#btn_student"},m=function(b,c,d,e,f,k){g=a(b);h=c;_templatelist=f;_categories=k;i=d;j=e},n=function(){g.on("click",l.BTN_COURSETOOLS,p);g.on("click",l.BTN_DUPLICATE,p);g.on("click",l.BTN_NEW,p);g.on("click",l.BTN_STUDENT,u)},o=function(b){if("btn_new"==b.attr("id")&&6>=_templatelist.length){a(".tmpl-label").bind("click",function(){q(a(this))})}},p=function(){k=a(this);var b="btn_new"==k.attr("id")?"Create new course":"Duplicate this course",c="btn_new"==k.attr("id")?"create a new":"duplicate this";templatenew="<div data-role=\"templateholder\" class = \"list-group\" >";if(0!=_templatelist){if(6<_templatelist.length){templatenew+="<label  class=\"col-form-label d-inline \" for=\"templateselect\">Template Select:</label><br> ";templatenew+="<div class=\"form-control-feedback invalid-feedback\" id=\"error_templateselect\"></div> ";templatenew+="<select class=\"custom-select\" id=\"templateselect\" ";templatenew+="<option value = 0 > Default Blank Course</option>";templatenew+="<option value = 0 > Default Blank Course</option>";a.each(_templatelist,function(a,b){templatenew+="<option value = "+b.id+">"+b.fullname+"</option>"});templatenew+="</select>"}else{a.each(_templatelist,function(a,b){templatenew+="<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action \" id = "+b.id+"><h6>"+b.fullname+"</h6><p><small>"+b.summary+"</small></p></div>"});templatenew+="<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action active\" id = \"0\" ><h6>Default Course</h6><p><small>Basic course template. No activites included </small></p></div>"}}else{templatenew+="<div data-role = \"templateselect\" class=\"tmpl-label list-group-item list-group-item-action active\" id = \"0\" ><h6>Default Course</h6><p><small>Basic course template. No activites included </small></p></div>"}templatebase="</div>";templatebase+="<br><br>";templatebase+="<div class=\"form-control-feedback invalid-feedback\" id=\"error_coursename\"></div> ";templatebase+="<label  class=\"col-form-label d-inline \" for=\"coursename\">Course Full Name:</label><input maxlength=\"254\" class=\"form-control \" type=\"text\" id=\"coursename\" name=\"coursename\"><br> ";templatebase+="<div class=\"form-control-feedback invalid-feedback\" id=\"error_shortname\"></div> ";templatebase+="<label class=\"col-form-label d-inline \" for=\"shortname\">Course Short Name:</label><input maxlength=\"254\" class=\"form-control \" type=\"text\" id=\"shortname\" name=\"shortname\"><br> ";templatebase+="<label  class=\"col-form-label d-inline \" for=\"category\">Course Category:</label><br> ";templatebase+="<div class=\"form-control-feedback invalid-feedback\" id=\"error_category\"></div> ";templatebase+="<select class=\"custom-select\" id=\"category\" ";if(0!=_categories){a.each(_categories,function(a,b){templatebase+="<option value = "+b.id+">"+b.name+"</option>"})}templatebase+="</select";templatenew+=templatebase;templateduplicate=templatebase;e.create({type:e.types.SAVE_CANCEL,title:b,body:"<p><b>Are you sure you want to "+c+" course?</b><br />"+("btn_new"==k.attr("id")?"<small>Select from the templates below:</small>":"<small>Student data will not be included in the duplicated course.</small>")+("btn_new"==k.attr("id")?templatenew:"")+(!("btn_new"==k.attr("id"))?templateduplicate:"")+"</p>"}).then(function(b){b.setSaveButtonText("btn_new"==k.attr("id")?"Create new course":"Duplicate this course");var c=b.getRoot();c.on(f.cancel,function(){});if("btn_new"==k.attr("id")){c.on(f.save,function(a){if(!r()){a.preventDefault()}else{s(k.attr("id"))}})}else{c.on(f.save,function(a){if(!r()){a.preventDefault()}else{t(k.attr("id"))}})}c.on(f.hidden,function(){a("#coursename").remove();a("#shortname").remove();a("#category").remove()});b.show()}).done(function(){if("btn_new"==k.attr("id")){o(k)}else{a("#coursename").val(i);a("#shortname").val(j)}})},q=function(b){templateHolder=a("div[data-role=\"templateholder\"");a(templateHolder).find(".active").removeClass("active");b.addClass("active")},r=function(){coursename=a("#coursename").val();shortname=a("#shortname").val();error_coursename=a("#error_coursename");error_shortname=a("#error_shortname");var b=!0;if(0==coursename.length){a(error_coursename).text("Please enter a name for the course");a(error_coursename).attr("display","block");a(error_coursename).show();b=!1}if(0==shortname.length){a(error_shortname).text("Please enter a short name for the course");a(error_shortname).attr("display","block");a(error_shortname).show();b=!1}if(!b){return!1}a(error_coursename).text("");a(error_shortname).text("");return!0},s=function(){if(!h){return}if(6<_templatelist.length){templateid=a("#templateselect").val()}else{templateHolder=a("div[data-role=\"templateholder\"");selectedTemplate=a(templateHolder).find(".active");templateid=a(selectedTemplate).attr("id")}coursename=a("#coursename").val();shortname=a("#shortname").val();categoryid=a("#category").val();var d={courseid:h,templateid:templateid,coursename:coursename,shortname:shortname,categoryid:categoryid},f={methodname:"theme_urcourses_default_header_create_course",args:d,fail:c.exception},g=b.call([f]);g[0].done(function(a){if(""!=a.error){title="ERROR:";info=a.error;e.create({title:title,body:"<p><b>"+info+"</b><br></p>"}).done(function(a){a.show()})}if(""!=a.url){window.location.href=a.url}}).fail(function(){c.exception})},t=function(){if(!h){return}coursename=a("#coursename").val();shortname=a("#shortname").val();categoryid=a("#category").val();var d={courseid:h,coursename:coursename,shortname:shortname,categoryid:categoryid},f={methodname:"theme_urcourses_default_header_duplicate_course",args:d,fail:c.exception},g=b.call([f]);g[0].done(function(a){if(""!=a.error){title="ERROR:";info=a.error;e.create({title:title,body:"<p><b>"+info+"</b><br></p>"}).done(function(a){a.show()})}if(""!=a.url){window.location.href=a.url}}).fail(function(){c.exception})},u=function(){var a=this.getAttribute("aria-username");e.create({type:e.types.SAVE_CANCEL,title:"Create and enroll test student account in course",body:"<p><b>Do you want to "+("create the test student account "+a+"+student@uregina.ca")+"?</b><br /></p>"}).then(function(b){b.setSaveButtonText("Create");var c=b.getRoot();c.on(f.cancel,function(){});c.on(f.save,function(){v(a)});b.show()})},v=function(a){if(!h){return}var d={courseid:h,username:a},e={methodname:"theme_urcourses_default_header_create_test_account",args:d,success:function success(a){w(a)},fail:c.exception},f=b.call([e]);f[0].done(function(a){w(a)}).fail(function(){c.exception})},w=function(b){title="Success: ";info="";action=" Would you like to logout, inorder to login to new account?";if(!1!=b.created&&!1!=b.enrolled){info=b.username+" was created and enrolled into this course. Login password is the same as current account."}else if(!1!=b.created&&!1==b.enrolled){info=b.username+" was created, but FAILED to be enrolled into this course"}else if(!1==b.created&&!1!=b.enrolled){info=b.username+" already existed, and has now been enrolled into this course. Login password is the same as current account."}else{title="ERROR:";info=b.username+" already exists and is enrolled into the course";e.create({title:title,body:"<p><b>"+info+"</b><br></p>"}).done(function(a){a.show()});return}e.create({type:e.types.SAVE_CANCEL,title:title,body:"<p><b>"+info+"</b><br>"+action+"<br /></p>"}).then(function(c){c.setSaveButtonText("Logout");var d=c.getRoot();d.on(f.cancel,function(){});d.on(f.save,function(){var c=a("a[data-title=\"logout,moodle\"]").attr("href");window.location.href=c;a("#username").value=b.username});c.show()})};return{init:function init(a,b,c,d,e,f){m(a,b,e,f,c,d);n()}}});
//# sourceMappingURL=course_request.min.js.map
