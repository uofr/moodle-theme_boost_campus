{"version":3,"sources":["../src/modal_help.js"],"names":["SELECTORS","SEARCH","SEARCH_BUTTON","SEARCH_CLEAR","SUGGESTIONS","SUGGESTION_ITEM","SEARCH_RESULT","BREADCRUMBS","BREADCRUMB_SEARCH","BREADCRUMB_HOME","BREADCRUMB_PAGE","TEMPLATES","MODAL_HELP_GUIDE_PAGE","MODAL_HELP_SEARCH_RESULTS","MODAL_HELP_BREADCRUMBS","ModalHelp","root","contextId","topicList","topicIndex","minSearchScore","searchBox","modal","find","searchButton","searchClear","suggestionBox","suggestionItemIndex","breadcrumbData","getRoot","on","ModalEvents","shown","initTopics","showLandingPage","hidden","resetModal","e","target","hideSuggestionBox","val","showSearchClear","hideSearchClear","updateSuggestions","clearSearch","query","showSearchResults","keyCode","KeyCodes","enter","getModal","focus","CustomEvents","events","activate","topicTitle","attr","topic","title","toLowerCase","url","showSuggestionPage","showSearchResult","arrowUp","arrowLeft","preventDefault","getSuggestionItems","length","eq","arrowDown","arrowRight","search","page","template","data","renderData","breadcrumbs","renderPromise","Templates","render","setBody","ModalHelpAjax","getTopicList","add","Notification","exception","getLandingPage","landingPage","html","defaultSuggestions","values","minScore","suggestions","getSuggestions","append","showSuggestionBox","get","Array","isArray","map","suggestion","searchGuides","searchResults","getGuidePage","guidePage","removeClass","scrollTop","addClass","Modal","registered","ModalRegistry","register","getType"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Campus - ModalHelp class\n *\n * @package    theme_urcourses_default\n * @author     John Lane\n *\n */\n\nimport $ from 'jquery';\nimport Notification from 'core/notification';\nimport Templates from 'core/templates';\nimport CustomEvents from 'core/custom_interaction_events';\nimport KeyCodes from 'core/key_codes';\nimport Modal from 'core/modal';\nimport ModalEvents from 'core/modal_events';\nimport ModalRegistry from 'core/modal_registry';\nimport ModalHelpAjax from 'theme_urcourses_default/modal_help_ajax';\nimport {FuzzySet} from 'theme_urcourses_default/fuzzyset';\n\nconst SELECTORS = {\n    SEARCH: '#modal_help_search',\n    SEARCH_BUTTON: '#modal_help_search_btn',\n    SEARCH_CLEAR: '#modal_help_search_clear',\n    SUGGESTIONS: '#modal_help_search_suggestions',\n    SUGGESTION_ITEM: '.modal-help-suggestion-item',\n    SEARCH_RESULT: '.modal-help-search-result',\n    BREADCRUMBS: '#breadcrumbs',\n    BREADCRUMB_SEARCH: '#breadcrumb_search',\n    BREADCRUMB_HOME: '#breadcrumb_home',\n    BREADCRUMB_PAGE: '#breadcrumb_page'\n};\n\nconst TEMPLATES = {\n    MODAL_HELP_GUIDE_PAGE: 'theme_urcourses_default/modal_help_guide_page',\n    MODAL_HELP_SEARCH_RESULTS: 'theme_urcourses_default/modal_help_search_results',\n    MODAL_HELP_BREADCRUMBS: 'theme_urcourses_default/modal_help_breadcrumbs'\n};\n\n/**\n * Help modal for UR Courses.\n *\n * @class ModalHelp\n * @property {Number} contextId - Current page context id. Null until it is set in init().\n * @property {Array} topicList - List of topcis for which there is help. Null until it is set in initContent().\n * @property {FuzzySet} topicIndex - FuzzySet to enable autocomplete.\n * @property {Number} minSearchScore - How similar a search term has to be to attempt autocomplete.\n * @property {JQuery} searchBox - Search field jQuery element.\n * @property {JQuery} searchButton - Search button jQuery object.\n * @property {JQuery} searchClear - Clear search jQuery object.\n * @property {JQuery} suggestionBox - Suggestion box jQuery object.\n * @property {Number} suggestionItemIndex - Index of the suggestion being highlighted.\n * @property {Object} breadcrumbData - Used to render breadcrumb template.\n */\nexport default class ModalHelp extends Modal {\n\n    constructor(root) {\n        super(root);\n\n        this.contextId = null;\n        this.topicList = null;\n        this.topicIndex = FuzzySet();\n        this.minSearchScore = 0;\n        this.searchBox = this.modal.find(SELECTORS.SEARCH);\n        this.searchButton = this.modal.find(SELECTORS.SEARCH_BUTTON);\n        this.searchClear = this.modal.find(SELECTORS.SEARCH_CLEAR);\n        this.suggestionBox = this.modal.find(SELECTORS.SUGGESTIONS);\n        this.suggestionItemIndex = 0;\n        this.breadcrumbData = {};\n    }\n\n    /**\n     * Sets context id and registers events.\n     *\n     * @method init\n     * @param {Number} contextId Id of the current page's context.\n     */\n    init(contextId) {\n        this.contextId = contextId;\n\n        this.getRoot().on(ModalEvents.shown, () => {\n            if (!this.topicList) {\n                this.initTopics();\n            }\n            this.showLandingPage();\n        });\n\n        this.getRoot().on(ModalEvents.hidden, () => {\n            this.resetModal();\n        });\n\n        this.getRoot().on('click', (e) => {\n            if (e.target !== this.searchBox[0] && e.target !== this.suggestionBox[0]) {\n                this.hideSuggestionBox();\n            }\n        });\n\n        this.searchBox.on('input', () => {\n            if (this.searchBox.val()) {\n                this.showSearchClear();\n            }\n            else {\n                this.hideSearchClear();\n            }\n            this.updateSuggestions();\n        });\n\n        this.searchBox.on('focus', () => {\n            this.updateSuggestions();\n        });\n\n        this.searchClear.on('click', () => {\n            this.clearSearch();\n        });\n\n        this.searchButton.on('click', () => {\n            const query = this.searchBox.val();\n            this.showSearchResults(query);\n            this.hideSuggestionBox();\n        });\n\n        this.searchBox.on('keydown', (e) => {\n            if (e.keyCode === KeyCodes.enter) {\n                const query = this.searchBox.val();\n                this.showSearchResults(query);\n                this.getModal().focus();\n                this.hideSuggestionBox();\n            }\n        });\n\n        this.suggestionBox.on(CustomEvents.events.activate, SELECTORS.SUGGESTION_ITEM, (e) => {\n            const topicTitle = $(e.target).attr('data-value');\n            const topic = this.topicList.find(topic => topic.title.toLowerCase() === topicTitle.toLowerCase());\n            const url = topic.url;\n            this.searchBox.val(topicTitle);\n            this.showSearchClear();\n            this.showSuggestionPage(url, topicTitle);\n        });\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.SEARCH_RESULT, (e) => {\n            const url = $(e.target).attr('data-url');\n            const title = $(e.target).attr('data-title');\n            this.showSearchResult(url, title);\n        });\n\n        this.searchBox.on('keydown', (e) => {\n            if (e.keyCode === KeyCodes.arrowUp || e.keyCode === KeyCodes.arrowLeft) {\n                e.preventDefault();\n                this.suggestionItemIndex = this.getSuggestionItems().length - 1;\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n            else if (e.keyCode === KeyCodes.arrowDown || e.keyCode === KeyCodes.arrowRight) {\n                e.preventDefault();\n                this.suggestionItemIndex = 0;\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n        });\n\n        this.suggestionBox.on('keydown', SELECTORS.SUGGESTION_ITEM, (e) => {\n            if (e.keyCode === KeyCodes.arrowUp || e.keyCode === KeyCodes.arrowLeft) {\n                e.preventDefault();\n                this.suggestionItemIndex--;\n                if (this.suggestionItemIndex < 0) {\n                    this.suggestionItemIndex = this.getSuggestionItems().length - 1;\n                }\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n            else if (e.keyCode === KeyCodes.arrowDown || e.keyCode === KeyCodes.arrowRight) {\n                e.preventDefault();\n                this.suggestionItemIndex++;\n                if (this.suggestionItemIndex >= this.getSuggestionItems().length) {\n                    this.suggestionItemIndex = 0;\n                }\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n        });\n\n        this.getRoot().on(CustomEvents.events.activate, SELECTORS.BREADCRUMB_HOME, () => {\n            if (this.breadcrumbData.search || this.breadcrumbData.page) {\n                this.showLandingPage();\n            }\n        });\n\n        this.getRoot().on(CustomEvents.events.activate, SELECTORS.BREADCRUMB_SEARCH, (e) => {\n            if (this.breadcrumbData.page) {\n                const query = $(e.target).attr('data-query');\n                this.showSearchResults(query);\n            }\n        });\n\n    }\n\n    /**\n     * Update the modal body using given template and data.\n     *\n     * @method render\n     * @param {String} template - The name of the template to render.\n     * @param {Object} data - Data for template.\n     * @param {Object} breadcrumbData - Data required for rending breadcrumbs.\n     */\n    async render(template, data, breadcrumbData) {\n        const renderData = {\n            data: data,\n            breadcrumbs: breadcrumbData\n        };\n        const renderPromise = Templates.render(template, renderData);\n        this.setBody(renderPromise);\n    }\n\n    /*\n     * Sets topicIndex and topicList.\n     *\n     * @method initTopics\n     */\n    async initTopics() {\n        try {\n            const topicList = await ModalHelpAjax.getTopicList(this.contextId);\n            this.topicList = topicList;\n            for (const topic of topicList) {\n                this.topicIndex.add(topic.title);\n            }\n        }\n        catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Outputs modal home page to modal.\n     *\n     * @method showLandingPage\n     */\n    async showLandingPage() {\n        try {\n            const landingPage = await ModalHelpAjax.getLandingPage(this.contextId);\n            this.breadcrumbData.search = false;\n            this.breadcrumbData.page = false;\n            this.render(TEMPLATES.MODAL_HELP_GUIDE_PAGE, landingPage, this.breadcrumbData);\n        }\n        catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Resets modal content.\n     *\n     * @method resetModal\n     */\n    resetModal() {\n        this.setBody('');\n        this.searchBox.val('');\n        this.suggestionBox.html('');\n    }\n\n    /**\n     * Updates the suggestion list based on whatever is in the search box.\n     *\n     * @method updateSuggestions\n     */\n    updateSuggestions() {\n        const query = this.searchBox.val();\n        const defaultSuggestions = this.topicIndex.values();\n        const minScore = this.minSearchScore;\n        const suggestions = this.getSuggestions(query, defaultSuggestions, minScore);\n        this.suggestionBox.html('');\n        this.suggestionBox.append(suggestions);\n        this.showSuggestionBox();\n    }\n\n    /**\n     * Get a list of suggestions based on the query.\n     *\n     * @method getSuggestions\n     * @param {String} query - What to fuzzy search for in the topicList.\n     * @param {Array} defaultSuggestions - Default suggestions to show if there is no match.\n     * @param {Number} minScore - How similar the query has to be to a topic.\n     * @returns {Array} An array of html tags.\n     */\n    getSuggestions(query, defaultSuggestions, minScore) {\n        let suggestions = this.topicIndex.get(query, defaultSuggestions, minScore);\n        if (Array.isArray(suggestions[0])) {\n            suggestions = suggestions.map(suggestion => suggestion[1]);\n        }\n        return suggestions.map(suggestion => `<a href=\"#\" class=\"modal-help-suggestion-item\"\n                                              data-value=\"${suggestion}\">${suggestion}</a>`);\n    }\n\n    /**\n     * Searches the guides and displays results.\n     *\n     * @method showSearchResults\n     * @param {String} query\n     */\n    async showSearchResults(query) {\n        if (!query) {\n            return;\n        }\n        try {\n            const searchResults = await ModalHelpAjax.searchGuides(this.contextId, query);\n            this.breadcrumbData.search = {\n                query: query\n            };\n            this.breadcrumbData.page = false;\n            this.render(TEMPLATES.MODAL_HELP_SEARCH_RESULTS, searchResults, this.breadcrumbData);\n        }\n        catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Render the page for the search result the user clicked on.\n     *\n     * @method showPage\n     * @param {String} url  - The url without the domain (ie /guides/instructor/...)\n     * @param {String} title - Page title.\n     */\n    async showSearchResult(url, title) {\n        try {\n            const guidePage = await ModalHelpAjax.getGuidePage(url);\n            this.breadcrumbData.page = {\n                url: url,\n                title: title\n            };\n            this.render(TEMPLATES.MODAL_HELP_GUIDE_PAGE, guidePage, this.breadcrumbData);\n        }\n        catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Render the page for the suggestion the user clicked on.\n     *\n     * @method showSuggestionPage\n     * @param {String} url - The url without the domain (ie: /guides/instructor/...)\n     * @param {String} title - Page title.\n     */\n    async showSuggestionPage(url, title) {\n        try {\n            const guidePage = await ModalHelpAjax.getGuidePage(url);\n            this.breadcrumbData.search = false;\n            this.breadcrumbData.page = {\n                url: url,\n                title: title\n            };\n            this.render(TEMPLATES.MODAL_HELP_GUIDE_PAGE, guidePage, this.breadcrumbData);\n        }\n        catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n\n    /**\n     * Clears whatever is in the search box.\n     *\n     * @method clearSearch\n     */\n    clearSearch() {\n        this.searchBox.val('');\n        this.hideSearchClear();\n    }\n\n    /**\n     * Removes d-none class from suggestion box and scrolls to the top of the list.\n     *\n     * @method showSuggestionBox\n     */\n    showSuggestionBox() {\n        this.suggestionBox.removeClass('d-none');\n        this.suggestionBox[0].scrollTop = 0;\n    }\n\n    /**\n     * Adds d-none class to suggestion box.\n     *\n     * @method hideSuggestionBox\n     */\n    hideSuggestionBox() {\n        this.suggestionBox.addClass('d-none');\n    }\n\n    /**\n     * Removes d-none class from clear search button.\n     *\n     * @method showSearchClear\n     */\n    showSearchClear() {\n        this.searchClear.removeClass('d-none');\n    }\n\n    /**\n     * Adds d-none class to clear search button.\n     *\n     * @method showSearchClear\n     */\n    hideSearchClear() {\n        this.searchClear.addClass('d-none');\n    }\n\n    /**\n     * Returns modal type. Used when creating the modal using ModalFactory.\n     *\n     * @method getType\n     * @returns {String}\n     */\n    static getType() {\n        return 'theme_urcourses_default-help';\n    }\n\n    /**\n     * Returns an array of suggestions in the suggestion box.\n     *\n     * @method getSuggestionItems\n     * @returns {JQuery}\n     */\n    getSuggestionItems() {\n        return this.suggestionBox.find(SELECTORS.SUGGESTION_ITEM);\n    }\n\n}\n\n// Setup code for adding ModalHelp to the modal factory.\nlet registered = false;\nif (!registered) {\n    ModalRegistry.register(ModalHelp.getType(), ModalHelp, 'theme_urcourses_default/modal_help');\n    registered = true;\n}\n"],"file":"modal_help.min.js"}