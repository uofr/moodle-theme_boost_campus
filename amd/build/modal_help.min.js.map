{"version":3,"sources":["../src/modal_help.js"],"names":["SELECTORS","SEARCH","SEARCH_BUTTON","SEARCH_CLEAR","SUGGESTIONS","SUGGESTION_ITEM","SEARCH_RESULT","BREADCRUMBS","BREADCRUMB_SEARCH","BREADCRUMB_HOME","BREADCRUMB_PAGE","TEMPLATES","MODAL_HELP_GUIDE_PAGE","MODAL_HELP_SEARCH_RESULTS","MODAL_HELP_BREADCRUMBS","ModalHelp","root","contextId","topicList","topicTitles","searchBox","modal","find","searchButton","searchClear","suggestionBox","suggestionItemIndex","breadcrumbData","search","page","home","getRoot","on","ModalEvents","shown","initTopics","showLandingPage","hidden","resetModal","e","target","hideSuggestionBox","val","showSearchClear","hideSearchClear","updateSuggestions","clearSearch","query","showSearchResults","keyCode","KeyCodes","enter","getModal","focus","CustomEvents","events","activate","topicTitle","attr","topic","title","toLowerCase","url","showSuggestionPage","showSearchResult","arrowUp","arrowLeft","preventDefault","getSuggestionItems","length","eq","arrowDown","arrowRight","template","data","renderData","breadcrumbs","renderPromise","Templates","render","setBody","ModalHelpAjax","getTopicList","map","FuzzySearch","setDictionary","Notification","exception","getLandingPage","landingPage","stringified","html","base","reg1","reg2","reg3","replace","suggestions","suggestionList","getSuggestions","append","showSuggestionBox","suggestion","searchGuides","searchResults","active","getGuidePage","guidePage","removeClass","scrollTop","addClass","Modal","registered","ModalRegistry","register","getType"],"mappings":"+YAuBA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,OACA,O,6jDAEMA,CAAAA,CAAS,CAAG,CACdC,MAAM,CAAE,oBADM,CAEdC,aAAa,CAAE,wBAFD,CAGdC,YAAY,CAAE,0BAHA,CAIdC,WAAW,CAAE,gCAJC,CAKdC,eAAe,CAAE,6BALH,CAMdC,aAAa,CAAE,2BAND,CAOdC,WAAW,CAAE,cAPC,CAQdC,iBAAiB,CAAE,oBARL,CASdC,eAAe,CAAE,kBATH,CAUdC,eAAe,CAAE,kBAVH,C,CAaZC,CAAS,CAAG,CACdC,qBAAqB,CAAE,+CADT,CAEdC,yBAAyB,CAAE,mDAFb,CAGdC,sBAAsB,CAAE,gDAHV,C,CAoBGC,C,oBAEjB,WAAYC,CAAZ,CAAkB,iBACd,wBAAMA,CAAN,GAEA,EAAKC,SAAL,CAAiB,IAAjB,CACA,EAAKC,SAAL,CAAiB,IAAjB,CACA,EAAKC,WAAL,CAAmB,IAAnB,CACA,EAAKC,SAAL,CAAiB,EAAKC,KAAL,CAAWC,IAAX,CAAgBtB,CAAS,CAACC,MAA1B,CAAjB,CACA,EAAKsB,YAAL,CAAoB,EAAKF,KAAL,CAAWC,IAAX,CAAgBtB,CAAS,CAACE,aAA1B,CAApB,CACA,EAAKsB,WAAL,CAAmB,EAAKH,KAAL,CAAWC,IAAX,CAAgBtB,CAAS,CAACG,YAA1B,CAAnB,CACA,EAAKsB,aAAL,CAAqB,EAAKJ,KAAL,CAAWC,IAAX,CAAgBtB,CAAS,CAACI,WAA1B,CAArB,CACA,EAAKsB,mBAAL,CAA2B,CAA3B,CACA,EAAKC,cAAL,CAAsB,CAACC,MAAM,GAAP,CAAgBC,IAAI,GAApB,CAA6BC,IAAI,GAAjC,CAAtB,CAXc,QAYjB,C,qCAQIb,C,CAAW,YACZ,KAAKA,SAAL,CAAiBA,CAAjB,CAEA,KAAKc,OAAL,GAAeC,EAAf,CAAkBC,UAAYC,KAA9B,CAAqC,UAAM,CACvC,GAAI,CAAC,CAAI,CAAChB,SAAV,CAAqB,CACjB,CAAI,CAACiB,UAAL,EACH,CACD,CAAI,CAACC,eAAL,EACH,CALD,EAOA,KAAKL,OAAL,GAAeC,EAAf,CAAkBC,UAAYI,MAA9B,CAAsC,UAAM,CACxC,CAAI,CAACC,UAAL,EACH,CAFD,EAIA,KAAKP,OAAL,GAAeC,EAAf,CAAkB,OAAlB,CAA2B,SAACO,CAAD,CAAO,CAC9B,GAAIA,CAAC,CAACC,MAAF,GAAa,CAAI,CAACpB,SAAL,CAAe,CAAf,CAAb,EAAkCmB,CAAC,CAACC,MAAF,GAAa,CAAI,CAACf,aAAL,CAAmB,CAAnB,CAAnD,CAA0E,CACtE,CAAI,CAACgB,iBAAL,EACH,CACJ,CAJD,EAMA,KAAKrB,SAAL,CAAeY,EAAf,CAAkB,OAAlB,CAA2B,UAAM,CAC7B,GAAI,CAAI,CAACZ,SAAL,CAAesB,GAAf,EAAJ,CAA0B,CACtB,CAAI,CAACC,eAAL,EACH,CAFD,IAEO,CACH,CAAI,CAACC,eAAL,EACH,CACD,CAAI,CAACC,iBAAL,EACH,CAPD,EASA,KAAKzB,SAAL,CAAeY,EAAf,CAAkB,OAAlB,CAA2B,UAAM,CAC7B,CAAI,CAACa,iBAAL,EACH,CAFD,EAIA,KAAKrB,WAAL,CAAiBQ,EAAjB,CAAoB,OAApB,CAA6B,UAAM,CAC/B,CAAI,CAACc,WAAL,EACH,CAFD,EAIA,KAAKvB,YAAL,CAAkBS,EAAlB,CAAqB,OAArB,CAA8B,UAAM,CAChC,GAAMe,CAAAA,CAAK,CAAG,CAAI,CAAC3B,SAAL,CAAesB,GAAf,EAAd,CACA,CAAI,CAACM,iBAAL,CAAuBD,CAAvB,EACA,CAAI,CAACN,iBAAL,EACH,CAJD,EAMA,KAAKrB,SAAL,CAAeY,EAAf,CAAkB,SAAlB,CAA6B,SAACO,CAAD,CAAO,CAChC,GAAIA,CAAC,CAACU,OAAF,GAAcC,UAASC,KAA3B,CAAkC,CAC9B,GAAMJ,CAAAA,CAAK,CAAG,CAAI,CAAC3B,SAAL,CAAesB,GAAf,EAAd,CACA,CAAI,CAACM,iBAAL,CAAuBD,CAAvB,EACA,CAAI,CAACK,QAAL,GAAgBC,KAAhB,GACA,CAAI,CAACZ,iBAAL,EACH,CACJ,CAPD,EASA,KAAKhB,aAAL,CAAmBO,EAAnB,CAAsBsB,UAAaC,MAAb,CAAoBC,QAA1C,CAAoDxD,CAAS,CAACK,eAA9D,CAA+E,SAACkC,CAAD,CAAO,IAC5EkB,CAAAA,CAAU,CAAG,cAAElB,CAAC,CAACC,MAAJ,EAAYkB,IAAZ,CAAiB,YAAjB,CAD+D,CAE5EC,CAAK,CAAG,CAAI,CAACzC,SAAL,CAAeI,IAAf,CAAoB,SAAAqC,CAAK,QAAIA,CAAAA,CAAK,CAACC,KAAN,CAAYC,WAAZ,KAA8BJ,CAAU,CAACI,WAAX,EAAlC,CAAzB,CAFoE,CAG5EC,CAAG,CAAGH,CAAK,CAACG,GAHgE,CAIlF,CAAI,CAAC1C,SAAL,CAAesB,GAAf,CAAmBe,CAAnB,EACA,CAAI,CAACd,eAAL,GACA,CAAI,CAACoB,kBAAL,CAAwBD,CAAxB,CAA6BL,CAA7B,CACH,CAPD,EASA,KAAKL,QAAL,GAAgBpB,EAAhB,CAAmBsB,UAAaC,MAAb,CAAoBC,QAAvC,CAAiDxD,CAAS,CAACM,aAA3D,CAA0E,SAACiC,CAAD,CAAO,IACvEuB,CAAAA,CAAG,CAAG,cAAEvB,CAAC,CAACC,MAAJ,EAAYkB,IAAZ,CAAiB,UAAjB,CADiE,CAEvEE,CAAK,CAAG,cAAErB,CAAC,CAACC,MAAJ,EAAYkB,IAAZ,CAAiB,YAAjB,CAF+D,CAG7E,CAAI,CAACM,gBAAL,CAAsBF,CAAtB,CAA2BF,CAA3B,CACH,CAJD,EAMA,KAAKxC,SAAL,CAAeY,EAAf,CAAkB,SAAlB,CAA6B,SAACO,CAAD,CAAO,CAChC,GAAIA,CAAC,CAACU,OAAF,GAAcC,UAASe,OAAvB,EAAkC1B,CAAC,CAACU,OAAF,GAAcC,UAASgB,SAA7D,CAAwE,CACpE3B,CAAC,CAAC4B,cAAF,GACA,CAAI,CAACzC,mBAAL,CAA2B,CAAI,CAAC0C,kBAAL,GAA0BC,MAA1B,CAAmC,CAA9D,CACA,CAAI,CAACD,kBAAL,GAA0BE,EAA1B,CAA6B,CAAI,CAAC5C,mBAAlC,EAAuD2B,KAAvD,EACH,CAJD,IAKK,IAAId,CAAC,CAACU,OAAF,GAAcC,UAASqB,SAAvB,EAAoChC,CAAC,CAACU,OAAF,GAAcC,UAASsB,UAA/D,CAA2E,CAC5EjC,CAAC,CAAC4B,cAAF,GACA,CAAI,CAACzC,mBAAL,CAA2B,CAA3B,CACA,CAAI,CAAC0C,kBAAL,GAA0BE,EAA1B,CAA6B,CAAI,CAAC5C,mBAAlC,EAAuD2B,KAAvD,EACH,CACJ,CAXD,EAaA,KAAK5B,aAAL,CAAmBO,EAAnB,CAAsB,SAAtB,CAAiChC,CAAS,CAACK,eAA3C,CAA4D,SAACkC,CAAD,CAAO,CAC/D,GAAIA,CAAC,CAACU,OAAF,GAAcC,UAASe,OAAvB,EAAkC1B,CAAC,CAACU,OAAF,GAAcC,UAASgB,SAA7D,CAAwE,CACpE3B,CAAC,CAAC4B,cAAF,GACA,CAAI,CAACzC,mBAAL,GACA,GAA+B,CAA3B,CAAA,CAAI,CAACA,mBAAT,CAAkC,CAC9B,CAAI,CAACA,mBAAL,CAA2B,CAAI,CAAC0C,kBAAL,GAA0BC,MAA1B,CAAmC,CACjE,CACD,CAAI,CAACD,kBAAL,GAA0BE,EAA1B,CAA6B,CAAI,CAAC5C,mBAAlC,EAAuD2B,KAAvD,EACH,CAPD,IAQK,IAAId,CAAC,CAACU,OAAF,GAAcC,UAASqB,SAAvB,EAAoChC,CAAC,CAACU,OAAF,GAAcC,UAASsB,UAA/D,CAA2E,CAC5EjC,CAAC,CAAC4B,cAAF,GACA,CAAI,CAACzC,mBAAL,GACA,GAAI,CAAI,CAACA,mBAAL,EAA4B,CAAI,CAAC0C,kBAAL,GAA0BC,MAA1D,CAAkE,CAC9D,CAAI,CAAC3C,mBAAL,CAA2B,CAC9B,CACD,CAAI,CAAC0C,kBAAL,GAA0BE,EAA1B,CAA6B,CAAI,CAAC5C,mBAAlC,EAAuD2B,KAAvD,EACH,CACJ,CAjBD,EAmBA,KAAKtB,OAAL,GAAeC,EAAf,CAAkBsB,UAAaC,MAAb,CAAoBC,QAAtC,CAAgDxD,CAAS,CAACS,eAA1D,CAA2E,UAAM,CAC7E,CAAI,CAAC2B,eAAL,EACH,CAFD,EAIA,KAAKL,OAAL,GAAeC,EAAf,CAAkBsB,UAAaC,MAAb,CAAoBC,QAAtC,CAAgDxD,CAAS,CAACQ,iBAA1D,CAA6E,SAAC+B,CAAD,CAAO,CAChF,GAAMQ,CAAAA,CAAK,CAAG,cAAER,CAAC,CAACC,MAAJ,EAAYkB,IAAZ,CAAiB,YAAjB,CAAd,CACA,CAAI,CAACV,iBAAL,CAAuBD,CAAvB,CACH,CAHD,CAKH,C,4EAUY0B,C,CAAUC,C,CAAM/C,C,2FACnBgD,C,CAAa,CACfD,IAAI,CAAEA,CADS,CAEfE,WAAW,CAAEjD,CAFE,C,CAIbkD,C,CAAgBC,UAAUC,MAAV,CAAiBN,CAAjB,CAA2BE,CAA3B,C,CACtB,KAAKK,OAAL,CAAaH,CAAb,E,4SAU4BI,WAAcC,YAAd,CAA2B,KAAKjE,SAAhC,C,QAAlBC,C,QACN,KAAKA,SAAL,CAAiBA,CAAjB,CACA,KAAKC,WAAL,CAAmBD,CAAS,CAACiE,GAAV,CAAc,SAAAxB,CAAK,QAAIA,CAAAA,CAAK,CAACC,KAAV,CAAnB,CAAnB,CACAwB,UAAYC,aAAZ,CAA0B,KAAKlE,WAA/B,E,mDAEAmE,UAAaC,SAAb,O,wUAWwBN,WAAcO,cAAd,CAA6B,KAAKvE,SAAlC,C,QAApBwE,C,QACJ,KAAK9D,cAAL,CAAoBG,IAApB,IACA,KAAKH,cAAL,CAAoBC,MAApB,IACA,KAAKD,cAAL,CAAoBE,IAApB,IACI6D,C,CAAcD,CAAW,CAACE,I,CAC1BC,C,CAAOH,CAAW,CAACG,I,CACnBC,C,CAAO,c,CACPC,C,CAAO,sB,CACPC,C,CAAO,qB,CAEXL,CAAW,CAAGA,CAAW,CAACM,OAAZ,CAAoBH,CAApB,CAA0BD,CAA1B,CAAd,CACAF,CAAW,CAAGA,CAAW,CAACM,OAAZ,CAAoBF,CAApB,CAA0B,UAASF,CAAnC,CAAd,CACAH,CAAW,CAACE,IAAZ,CAAmBD,CAAW,CAACM,OAAZ,CAAoBD,CAApB,CAA0B,SAAQH,CAAlC,CAAnB,CACA,KAAKb,MAAL,CAAYpE,CAAS,CAACC,qBAAtB,CAA6C6E,CAA7C,CAA0D,KAAK9D,cAA/D,E,qDAEA2D,UAAaC,SAAb,O,6KASK,CACT,KAAKP,OAAL,CAAa,EAAb,EACA,KAAK5D,SAAL,CAAesB,GAAf,CAAmB,EAAnB,EACA,KAAKjB,aAAL,CAAmBkE,IAAnB,CAAwB,EAAxB,CACH,C,6DAOmB,IACV5C,CAAAA,CAAK,CAAG,KAAK3B,SAAL,CAAesB,GAAf,EADE,CAEZuD,CAAW,CAAGb,UAAYxD,MAAZ,CAAmBmB,CAAnB,CAFF,CAGhB,GAAI,CAACkD,CAAW,CAAC5B,MAAjB,CAAyB,CACrB4B,CAAW,CAAG,KAAK9E,WACtB,CACD,GAAM+E,CAAAA,CAAc,CAAG,KAAKC,cAAL,CAAoBF,CAApB,CAAvB,CACA,KAAKxE,aAAL,CAAmBkE,IAAnB,CAAwB,EAAxB,EACA,KAAKlE,aAAL,CAAmB2E,MAAnB,CAA0BF,CAA1B,EACA,KAAKG,iBAAL,EACH,C,sDAScJ,C,CAAa,CACxB,MAAOA,CAAAA,CAAW,CAACd,GAAZ,CAAgB,SAAAmB,CAAU,iIACmBA,CADnB,eACkCA,CADlC,SAA1B,CAEV,C,uFAQuBvD,C,4FACfA,C,0EAI2BkC,WAAcsB,YAAd,CAA2B,KAAKtF,SAAhC,CAA2C8B,CAA3C,C,QAAtByD,C,QACN,KAAK7E,cAAL,CAAoBG,IAApB,IACA,KAAKH,cAAL,CAAoBC,MAApB,CAA6B,CACzBmB,KAAK,CAAEA,CADkB,CAEzB0D,MAAM,GAFmB,CAA7B,CAIA,KAAK9E,cAAL,CAAoBE,IAApB,IACA,KAAKkD,MAAL,CAAYpE,CAAS,CAACE,yBAAtB,CAAiD2F,CAAjD,CAAgE,KAAK7E,cAArE,E,qDAEA2D,UAAaC,SAAb,O,sNAWezB,C,CAAKF,C,iHAEIqB,WAAcyB,YAAd,CAA2B5C,CAA3B,C,QAAlB6C,C,QACN,KAAKhF,cAAL,CAAoBG,IAApB,IACA,KAAKH,cAAL,CAAoBC,MAApB,CAA2B6E,MAA3B,IACA,KAAK9E,cAAL,CAAoBE,IAApB,CAA2B,CACvBiC,GAAG,CAAEA,CADkB,CAEvBF,KAAK,CAAEA,CAFgB,CAA3B,CAIA,KAAKmB,MAAL,CAAYpE,CAAS,CAACC,qBAAtB,CAA6C+F,CAA7C,CAAwD,KAAKhF,cAA7D,E,qDAGA2D,UAAaC,SAAb,O,uNAWiBzB,C,CAAKF,C,iHAEEqB,WAAcyB,YAAd,CAA2B5C,CAA3B,C,QAAlB6C,C,QACN,KAAKhF,cAAL,CAAoBG,IAApB,IACA,KAAKH,cAAL,CAAoBC,MAApB,IACA,KAAKD,cAAL,CAAoBE,IAApB,CAA2B,CACvBiC,GAAG,CAAEA,CADkB,CAEvBF,KAAK,CAAEA,CAFgB,CAA3B,CAIA,KAAKmB,MAAL,CAAYpE,CAAS,CAACC,qBAAtB,CAA6C+F,CAA7C,CAAwD,KAAKhF,cAA7D,E,qDAEA2D,UAAaC,SAAb,O,kLAUM,CACV,KAAKnE,SAAL,CAAesB,GAAf,CAAmB,EAAnB,EACA,KAAKE,eAAL,EACH,C,6DAOmB,CAChB,KAAKnB,aAAL,CAAmBmF,WAAnB,CAA+B,QAA/B,EACA,KAAKnF,aAAL,CAAmB,CAAnB,EAAsBoF,SAAtB,CAAkC,CACrC,C,6DAOmB,CAChB,KAAKpF,aAAL,CAAmBqF,QAAnB,CAA4B,QAA5B,CACH,C,yDAOiB,CACd,KAAKtF,WAAL,CAAiBoF,WAAjB,CAA6B,QAA7B,CACH,C,yDAOiB,CACd,KAAKpF,WAAL,CAAiBsF,QAAjB,CAA0B,QAA1B,CACH,C,+DAkBoB,CACjB,MAAO,MAAKrF,aAAL,CAAmBH,IAAnB,CAAwBtB,CAAS,CAACK,eAAlC,CACV,C,2CAZgB,CACb,MAAO,8BACV,C,cApWkC0G,S,cAmXvC,GAAIC,CAAAA,CAAU,GAAd,CACA,GAAI,CAACA,CAAL,CAAiB,CACbC,UAAcC,QAAd,CAAuBnG,CAAS,CAACoG,OAAV,EAAvB,CAA4CpG,CAA5C,CAAuD,oCAAvD,EACAiG,CAAU,GACb,C","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Theme Boost Campus - ModalHelp class\n *\n * @package    theme_urcourses_default\n * @author     John Lane\n *\n */\n\nimport $ from 'jquery';\nimport Notification from 'core/notification';\nimport Templates from 'core/templates';\nimport CustomEvents from 'core/custom_interaction_events';\nimport KeyCodes from 'core/key_codes';\nimport Modal from 'core/modal';\nimport ModalEvents from 'core/modal_events';\nimport ModalRegistry from 'core/modal_registry';\nimport ModalHelpAjax from 'theme_urcourses_default/modal_help_ajax';\nimport FuzzySearch from 'theme_urcourses_default/fuzzysearch';\n\nconst SELECTORS = {\n    SEARCH: '#modal_help_search',\n    SEARCH_BUTTON: '#modal_help_search_btn',\n    SEARCH_CLEAR: '#modal_help_search_clear',\n    SUGGESTIONS: '#modal_help_search_suggestions',\n    SUGGESTION_ITEM: '.modal-help-suggestion-item',\n    SEARCH_RESULT: '.modal-help-search-result',\n    BREADCRUMBS: '#breadcrumbs',\n    BREADCRUMB_SEARCH: '#breadcrumb_search',\n    BREADCRUMB_HOME: '#breadcrumb_home',\n    BREADCRUMB_PAGE: '#breadcrumb_page'\n};\n\nconst TEMPLATES = {\n    MODAL_HELP_GUIDE_PAGE: 'theme_urcourses_default/modal_help_guide_page',\n    MODAL_HELP_SEARCH_RESULTS: 'theme_urcourses_default/modal_help_search_results',\n    MODAL_HELP_BREADCRUMBS: 'theme_urcourses_default/modal_help_breadcrumbs'\n};\n\n/**\n * Help modal for UR Courses.\n *\n * @class ModalHelp\n * @property {Number} contextId - Current page context id. Null until it is set in init().\n * @property {Array} topicList - List of topcis for which there is help. Null until it is set in initContent().\n * @property {Array} topicTitles - Just the titles.\n * @property {JQuery} searchBox - Search field jQuery element.\n * @property {JQuery} searchButton - Search button jQuery object.\n * @property {JQuery} searchClear - Clear search jQuery object.\n * @property {JQuery} suggestionBox - Suggestion box jQuery object.\n * @property {Number} suggestionItemIndex - Index of the suggestion being highlighted.\n * @property {Object} breadcrumbData - Used to render breadcrumb template.\n */\nexport default class ModalHelp extends Modal {\n\n    constructor(root) {\n        super(root);\n\n        this.contextId = null;\n        this.topicList = null;\n        this.topicTitles = null;\n        this.searchBox = this.modal.find(SELECTORS.SEARCH);\n        this.searchButton = this.modal.find(SELECTORS.SEARCH_BUTTON);\n        this.searchClear = this.modal.find(SELECTORS.SEARCH_CLEAR);\n        this.suggestionBox = this.modal.find(SELECTORS.SUGGESTIONS);\n        this.suggestionItemIndex = 0;\n        this.breadcrumbData = {search: false, page: false, home: false};\n    }\n\n    /**\n     * Sets context id and registers events.\n     *\n     * @method init\n     * @param {Number} contextId Id of the current page's context.\n     */\n    init(contextId) {\n        this.contextId = contextId;\n\n        this.getRoot().on(ModalEvents.shown, () => {\n            if (!this.topicList) {\n                this.initTopics();\n            }\n            this.showLandingPage();\n        });\n\n        this.getRoot().on(ModalEvents.hidden, () => {\n            this.resetModal();\n        });\n\n        this.getRoot().on('click', (e) => {\n            if (e.target !== this.searchBox[0] && e.target !== this.suggestionBox[0]) {\n                this.hideSuggestionBox();\n            }\n        });\n\n        this.searchBox.on('input', () => {\n            if (this.searchBox.val()) {\n                this.showSearchClear();\n            } else {\n                this.hideSearchClear();\n            }\n            this.updateSuggestions();\n        });\n\n        this.searchBox.on('focus', () => {\n            this.updateSuggestions();\n        });\n\n        this.searchClear.on('click', () => {\n            this.clearSearch();\n        });\n\n        this.searchButton.on('click', () => {\n            const query = this.searchBox.val();\n            this.showSearchResults(query);\n            this.hideSuggestionBox();\n        });\n\n        this.searchBox.on('keydown', (e) => {\n            if (e.keyCode === KeyCodes.enter) {\n                const query = this.searchBox.val();\n                this.showSearchResults(query);\n                this.getModal().focus();\n                this.hideSuggestionBox();\n            }\n        });\n\n        this.suggestionBox.on(CustomEvents.events.activate, SELECTORS.SUGGESTION_ITEM, (e) => {\n            const topicTitle = $(e.target).attr('data-value');\n            const topic = this.topicList.find(topic => topic.title.toLowerCase() === topicTitle.toLowerCase());\n            const url = topic.url;\n            this.searchBox.val(topicTitle);\n            this.showSearchClear();\n            this.showSuggestionPage(url, topicTitle);\n        });\n\n        this.getModal().on(CustomEvents.events.activate, SELECTORS.SEARCH_RESULT, (e) => {\n            const url = $(e.target).attr('data-url');\n            const title = $(e.target).attr('data-title');\n            this.showSearchResult(url, title);\n        });\n\n        this.searchBox.on('keydown', (e) => {\n            if (e.keyCode === KeyCodes.arrowUp || e.keyCode === KeyCodes.arrowLeft) {\n                e.preventDefault();\n                this.suggestionItemIndex = this.getSuggestionItems().length - 1;\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n            else if (e.keyCode === KeyCodes.arrowDown || e.keyCode === KeyCodes.arrowRight) {\n                e.preventDefault();\n                this.suggestionItemIndex = 0;\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n        });\n\n        this.suggestionBox.on('keydown', SELECTORS.SUGGESTION_ITEM, (e) => {\n            if (e.keyCode === KeyCodes.arrowUp || e.keyCode === KeyCodes.arrowLeft) {\n                e.preventDefault();\n                this.suggestionItemIndex--;\n                if (this.suggestionItemIndex < 0) {\n                    this.suggestionItemIndex = this.getSuggestionItems().length - 1;\n                }\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n            else if (e.keyCode === KeyCodes.arrowDown || e.keyCode === KeyCodes.arrowRight) {\n                e.preventDefault();\n                this.suggestionItemIndex++;\n                if (this.suggestionItemIndex >= this.getSuggestionItems().length) {\n                    this.suggestionItemIndex = 0;\n                }\n                this.getSuggestionItems().eq(this.suggestionItemIndex).focus();\n            }\n        });\n\n        this.getRoot().on(CustomEvents.events.activate, SELECTORS.BREADCRUMB_HOME, () => {\n            this.showLandingPage();\n        });\n\n        this.getRoot().on(CustomEvents.events.activate, SELECTORS.BREADCRUMB_SEARCH, (e) => {\n            const query = $(e.target).attr('data-query');\n            this.showSearchResults(query);\n        });\n\n    }\n\n    /**\n     * Update the modal body using given template and data.\n     *\n     * @method render\n     * @param {String} template - The name of the template to render.\n     * @param {Object} data - Data for template.\n     * @param {Object} breadcrumbData - Data required for rending breadcrumbs.\n     */\n    async render(template, data, breadcrumbData) {\n        const renderData = {\n            data: data,\n            breadcrumbs: breadcrumbData\n        };\n        const renderPromise = Templates.render(template, renderData);\n        this.setBody(renderPromise);\n    }\n\n    /*\n     * Sets topicIndex and topicList.\n     *\n     * @method initTopics\n     */\n    async initTopics() {\n        try {\n            const topicList = await ModalHelpAjax.getTopicList(this.contextId);\n            this.topicList = topicList;\n            this.topicTitles = topicList.map(topic => topic.title);\n            FuzzySearch.setDictionary(this.topicTitles);\n        } catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Outputs modal home page to modal.\n     *\n     * @method showLandingPage\n     */\n    async showLandingPage() {\n        try {\n            var landingPage = await ModalHelpAjax.getLandingPage(this.contextId);\n            this.breadcrumbData.home = true;\n            this.breadcrumbData.search = false;\n            this.breadcrumbData.page = false;\n            var stringified = landingPage.html;\n            var base = landingPage.base;\n            var reg1 = /\\.\\/|\\.\\.\\//g;\n            var reg2 = /href=\"\\b(?!https\\b)/g;\n            var reg3 = /src=\"\\b(?!https\\b)/g;\n\n            stringified = stringified.replace(reg1, base);\n            stringified = stringified.replace(reg2, 'href=\"'+base);\n            landingPage.html = stringified.replace(reg3, 'src=\"'+base);\n            this.render(TEMPLATES.MODAL_HELP_GUIDE_PAGE, landingPage, this.breadcrumbData);\n        } catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Resets modal content.\n     *\n     * @method resetModal\n     */\n    resetModal() {\n        this.setBody('');\n        this.searchBox.val('');\n        this.suggestionBox.html('');\n    }\n\n    /**\n     * Updates the suggestion list based on whatever is in the search box.\n     *\n     * @method updateSuggestions\n     */\n    updateSuggestions() {\n        const query = this.searchBox.val();\n        let suggestions = FuzzySearch.search(query);\n        if (!suggestions.length) {\n            suggestions = this.topicTitles;\n        }\n        const suggestionList = this.getSuggestions(suggestions);\n        this.suggestionBox.html('');\n        this.suggestionBox.append(suggestionList);\n        this.showSuggestionBox();\n    }\n\n    /**\n     * Returns html markup based on list of suggested words.\n     *\n     * @method getSuggestions\n     * @param {Array} suggestions - List of suggested words.\n     * @returns {Array} An array of html tags.\n     */\n    getSuggestions(suggestions) {\n        return suggestions.map(suggestion => `<a href=\"#\" class=\"modal-help-suggestion-item\"\n                                              data-value=\"${suggestion}\">${suggestion}</a>`);\n    }\n\n    /**\n     * Searches the guides and displays results.\n     *\n     * @method showSearchResults\n     * @param {String} query\n     */\n    async showSearchResults(query) {\n        if (!query) {\n            return;\n        }\n        try {\n            const searchResults = await ModalHelpAjax.searchGuides(this.contextId, query);\n            this.breadcrumbData.home = false;\n            this.breadcrumbData.search = {\n                query: query,\n                active: true\n            };\n            this.breadcrumbData.page = false;\n            this.render(TEMPLATES.MODAL_HELP_SEARCH_RESULTS, searchResults, this.breadcrumbData);\n        } catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Render the page for the search result the user clicked on.\n     *\n     * @method showPage\n     * @param {String} url  - The url without the domain (ie /guides/instructor/...)\n     * @param {String} title - Page title.\n     */\n    async showSearchResult(url, title) {\n        try {\n            const guidePage = await ModalHelpAjax.getGuidePage(url);\n            this.breadcrumbData.home = false;\n            this.breadcrumbData.search.active = false;\n            this.breadcrumbData.page = {\n                url: url,\n                title: title\n            };\n            this.render(TEMPLATES.MODAL_HELP_GUIDE_PAGE, guidePage, this.breadcrumbData);\n        }\n        catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n    /**\n     * Render the page for the suggestion the user clicked on.\n     *\n     * @method showSuggestionPage\n     * @param {String} url - The url without the domain (ie: /guides/instructor/...)\n     * @param {String} title - Page title.\n     */\n    async showSuggestionPage(url, title) {\n        try {\n            const guidePage = await ModalHelpAjax.getGuidePage(url);\n            this.breadcrumbData.home = false;\n            this.breadcrumbData.search = false;\n            this.breadcrumbData.page = {\n                url: url,\n                title: title\n            };\n            this.render(TEMPLATES.MODAL_HELP_GUIDE_PAGE, guidePage, this.breadcrumbData);\n        } catch (error) {\n            Notification.exception(error);\n        }\n    }\n\n\n    /**\n     * Clears whatever is in the search box.\n     *\n     * @method clearSearch\n     */\n    clearSearch() {\n        this.searchBox.val('');\n        this.hideSearchClear();\n    }\n\n    /**\n     * Removes d-none class from suggestion box and scrolls to the top of the list.\n     *\n     * @method showSuggestionBox\n     */\n    showSuggestionBox() {\n        this.suggestionBox.removeClass('d-none');\n        this.suggestionBox[0].scrollTop = 0;\n    }\n\n    /**\n     * Adds d-none class to suggestion box.\n     *\n     * @method hideSuggestionBox\n     */\n    hideSuggestionBox() {\n        this.suggestionBox.addClass('d-none');\n    }\n\n    /**\n     * Removes d-none class from clear search button.\n     *\n     * @method showSearchClear\n     */\n    showSearchClear() {\n        this.searchClear.removeClass('d-none');\n    }\n\n    /**\n     * Adds d-none class to clear search button.\n     *\n     * @method showSearchClear\n     */\n    hideSearchClear() {\n        this.searchClear.addClass('d-none');\n    }\n\n    /**\n     * Returns modal type. Used when creating the modal using ModalFactory.\n     *\n     * @method getType\n     * @returns {String}\n     */\n    static getType() {\n        return 'theme_urcourses_default-help';\n    }\n\n    /**\n     * Returns an array of suggestions in the suggestion box.\n     *\n     * @method getSuggestionItems\n     * @returns {JQuery}\n     */\n    getSuggestionItems() {\n        return this.suggestionBox.find(SELECTORS.SUGGESTION_ITEM);\n    }\n\n}\n\n// Setup code for adding ModalHelp to the modal factory.\nlet registered = false;\nif (!registered) {\n    ModalRegistry.register(ModalHelp.getType(), ModalHelp, 'theme_urcourses_default/modal_help');\n    registered = true;\n}\n"],"file":"modal_help.min.js"}